<mxfile host="app.diagrams.net" modified="2023-11-23T01:35:12.572Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36" etag="3L4xmrjDXa9Q65izakb0" version="22.1.3" type="google" pages="7">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="kcp creation sequence diagram">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="31veatcvXabuM6n3mju--25" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="799" as="sourcePoint" />
            <mxPoint x="940" y="900" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="799" />
              <mxPoint x="1000" y="900" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="O6Msf0nIQJOXLwqsJY90-4" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="620" as="sourcePoint" />
            <mxPoint x="940" y="780" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="620" />
              <mxPoint x="1000" y="780" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="capi-controller-manager" link="data:page/id,jB_KwWKISDssQRoUF651" id="xfaPNnZRIsi5CIh0o9ph-0">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="840" y="40" width="200" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="capo-controller-manager&lt;br&gt;（cluster-api openstack provider）" link="data:page/id,1GsGqCXN8Yxk1cSTd2W0" id="xfaPNnZRIsi5CIh0o9ph-1">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="40" y="40" width="200" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="capi-kubeadm-control-plane-controller-manager" link="data:page/id,fJfRLFwB4LryNWWHjsvg" id="xfaPNnZRIsi5CIh0o9ph-2">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="440" y="40" width="200" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="capi-kubeadm-bootstrap-controller-manager" link="data:page/id,9yOwVbE0o5gcLiuX17Gm" id="xfaPNnZRIsi5CIh0o9ph-4">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="1440" y="40" width="200" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="9UiaGdn9NneoMvXGy8pM-0" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="xfaPNnZRIsi5CIh0o9ph-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="130" y="100" as="sourcePoint" />
            <mxPoint x="140" y="5120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9UiaGdn9NneoMvXGy8pM-1" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="xfaPNnZRIsi5CIh0o9ph-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="560" y="90" as="sourcePoint" />
            <mxPoint x="540" y="5120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9UiaGdn9NneoMvXGy8pM-2" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="xfaPNnZRIsi5CIh0o9ph-0" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="320" as="sourcePoint" />
            <mxPoint x="940" y="5120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9UiaGdn9NneoMvXGy8pM-3" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="xfaPNnZRIsi5CIh0o9ph-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1550" y="90" as="sourcePoint" />
            <mxPoint x="1540" y="5120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1540" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="S0s1iUTrSwCvE1cxI8T3-1" value="Create &lt;b&gt;OpenStackCluster&lt;/b&gt; Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-120" y="100" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="S0s1iUTrSwCvE1cxI8T3-7" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="EaBbJLAaGLSF6oYMtBNR-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="160" as="sourcePoint" />
            <mxPoint x="140" y="520" as="targetPoint" />
            <Array as="points">
              <mxPoint x="200" y="155" />
              <mxPoint x="200" y="520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;OpenStackCluster contains keystone auth secret in spec.identityRef&lt;br&gt;・Create Network（k8s-clusterapi-cluster-&amp;lt;NS&amp;gt;-&amp;lt;CLUSTER&amp;gt;）&lt;br&gt;・Create Subnet（from spec.nodeCidr, spec.dnsNameservers）&lt;br&gt;・Create Port from existing network (from spec.externalNetworkId)&lt;br&gt;　・Used in spec.controlPlaneEndpoint.host&lt;br&gt;・Create SecurityGroup&lt;br&gt;　・k8s-cluster-&amp;lt;NS&amp;gt;-&amp;lt;CLUSTER&amp;gt;-secgroup-worker&lt;br&gt;　・k8s-cluster-&amp;lt;NS&amp;gt;-&amp;lt;CLUSTER&amp;gt;-secgroup-controlplane&lt;br&gt;・Create SecurityGroup Rule&lt;br&gt;&lt;br&gt;&amp;nbsp;Update OpenStackClustrer.Spec and OpenStackCluster.Status&lt;br&gt;・Spec&lt;br&gt;　・cloudName, apiServerLoadBalancer, ...&lt;br&gt;・Status（include created / used resources）&lt;br&gt;　・controlPlaneSecurityGroup, workerSecurityGroup&lt;br&gt;　・externalNetwork, failureDomains, network" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackcluster_controller.go#L419" id="S0s1iUTrSwCvE1cxI8T3-11">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="-6" y="190" width="376" height="270" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&amp;nbsp;OpenStackCluster.Status.Ready = true" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackcluster_controller.go#L298" id="sGmMWHBVILiOfLJFSeOk-1">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="90" y="470" width="220" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="KOVakj37ok9e6TtMFN-b-1" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="590" as="sourcePoint" />
            <mxPoint x="940" y="590" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="EaBbJLAaGLSF6oYMtBNR-1" value="Reconcile &lt;b&gt;OpenStackCluster&lt;/b&gt; Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-120" y="140" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd78qVggPRkEUmriDfOX-0" value="Reconcile &lt;b&gt;Cluster&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="680" y="605" width="260" height="30" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div style=&quot;text-align: center;&quot;&gt;&amp;nbsp;＜ reconcileInfrastructure ＞&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;・Retrieve &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;OpenStackCluster&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt; from &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;Cluster.Spec.InfrastructureRef&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;・Retrieve some information from infrastructure and sync it to Cluster&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・&lt;b&gt;Cluster.Status.InfrastructureReady&lt;/b&gt; = &lt;b&gt;OpenStackCluster.Status.Ready&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・&lt;b&gt;Cluster.Spec.ControlPlaneEndpoint&lt;/b&gt; = &lt;b&gt;OpenStackCluster.Spec.ControlPlaneEndpoint&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・&lt;b&gt;Cluster.Status.FailureDomain &lt;/b&gt;= &lt;b&gt;OpenStack.Status.FailureDomain&lt;/b&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller_phases.go#L183-L214" id="gd78qVggPRkEUmriDfOX-5">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="850" y="650" width="529" height="120" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;＜ reconcilePhase ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;b&gt;Cluster.Status.InfrastructureReady&lt;/b&gt; &amp;amp;&amp;amp; &lt;b&gt;Cluster.Spec.ControlPlaneEndpoint&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;=&amp;gt; &lt;b&gt;Cluster.Status.Phase.Provisioned&lt;/b&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller_phases.go#L55-L57" id="gd78qVggPRkEUmriDfOX-7">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="850" y="810" width="480" height="70" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="gd78qVggPRkEUmriDfOX-10" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="155" as="sourcePoint" />
            <mxPoint x="940" y="241" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="155" />
              <mxPoint x="1000" y="241" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gd78qVggPRkEUmriDfOX-11" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="255" as="sourcePoint" />
            <mxPoint x="940" y="341" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="255" />
              <mxPoint x="1000" y="341" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gd78qVggPRkEUmriDfOX-12" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="365" as="sourcePoint" />
            <mxPoint x="940" y="451" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="365" />
              <mxPoint x="1000" y="451" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="gd78qVggPRkEUmriDfOX-13" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="475" as="sourcePoint" />
            <mxPoint x="940" y="561" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="475" />
              <mxPoint x="1000" y="561" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="＜ reconcileInfrastructure ＞&lt;br&gt;Set&amp;nbsp;&lt;font color=&quot;#0000ff&quot; style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; OpenStackCluster&lt;/font&gt;&lt;br&gt;Waiting for&lt;br&gt;&lt;b&gt;OpenStackCluster.Status.Ready &lt;/b&gt;is&lt;b&gt; True&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller_phases.go#L195-L198" id="gd78qVggPRkEUmriDfOX-15">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="163" width="340" height="70" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&amp;nbsp;＜ reconcileControlPlane ＞&lt;br&gt;Set&amp;nbsp;&lt;font color=&quot;#0000ff&quot; style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; KubeadmControlPlane&lt;/font&gt;&lt;br&gt;Waiting for&lt;br&gt;&lt;b&gt;KueadmControlPlane.Status.{Ready, Initialized}&amp;nbsp;&lt;/b&gt;is&lt;b&gt; True&lt;br&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller_phases.go#L245-L275" id="gd78qVggPRkEUmriDfOX-16">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="263" width="340" height="70" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&amp;nbsp;＜ reconcileKubeconfig ＞&lt;br&gt;If a &lt;b&gt;ControlPlaneRef&lt;/b&gt; is set, then the Control Plane Provider is responsible for generating the &lt;b&gt;kubeconfig&lt;/b&gt;." link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller_phases.go#L287-L292" id="gd78qVggPRkEUmriDfOX-17">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="373" width="340" height="70" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&amp;nbsp;＜ reconcileKubeconfig ＞&lt;br&gt;If &lt;b&gt;ControlPlaneRef&lt;/b&gt; is set, this process is skipped." link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller.go#L480-L485" id="gd78qVggPRkEUmriDfOX-18">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="490" width="340" height="53" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--23" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="gd78qVggPRkEUmriDfOX-19" target="xfaPNnZRIsi5CIh0o9ph-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gd78qVggPRkEUmriDfOX-19" value="Reconcile &lt;b&gt;Cluster&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="680" y="140" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="O6Msf0nIQJOXLwqsJY90-3" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;edgeStyle=orthogonalEdgeStyle;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="gd78qVggPRkEUmriDfOX-15" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1280" y="200" as="sourcePoint" />
            <mxPoint x="940" y="590" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1310" y="198" />
              <mxPoint x="1310" y="590" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-0" value="Create &lt;b&gt;KubeadmControlPlane&lt;/b&gt; Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="100" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-1" value="Create &lt;b&gt;Cluster&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="680" y="100" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-3" value="Reconcile &lt;b&gt;KubeadmControlPlane&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="240" y="140" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-2" value="Create &lt;b&gt;KubeadmConfig&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1280" y="1220" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-4" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="541" y="156" as="sourcePoint" />
            <mxPoint x="541" y="270" as="targetPoint" />
            <Array as="points">
              <mxPoint x="601" y="156" />
              <mxPoint x="600" y="270" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Waiting for set&lt;br&gt;&lt;b&gt;KubeadmControlPlane.metadata.ownerReferences&lt;br&gt;&lt;/b&gt;by &lt;b&gt;Cluster&lt;br&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L147-L156" id="g-v6_2hosOyxJWGCfkAE-5">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="560" y="200" width="340" height="50" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-7" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="341" as="sourcePoint" />
            <mxPoint x="540" y="341" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-8" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="370" as="sourcePoint" />
            <mxPoint x="540" y="540" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="370" />
              <mxPoint x="599" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Set &lt;font color=&quot;#0000ff&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; OpenStackMachineTemplate&lt;/font&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L342-L345" id="g-v6_2hosOyxJWGCfkAE-9">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="550" y="388" width="380" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="Waiting for&lt;br&gt;&lt;b&gt;Cluster.Status.InfrastructureReady &lt;/b&gt;is &lt;b&gt;True&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L347-L351" id="g-v6_2hosOyxJWGCfkAE-10">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="550" y="460" width="340" height="50" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-11" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="780" as="sourcePoint" />
            <mxPoint x="540" y="780" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="g-v6_2hosOyxJWGCfkAE-12" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="920" as="sourcePoint" />
            <mxPoint x="540" y="980" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="920" />
              <mxPoint x="600" y="980" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Generate &lt;b&gt;kubeconfig&lt;/b&gt; &lt;b&gt;Secret&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L364-L370" id="g-v6_2hosOyxJWGCfkAE-15">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="550" y="930" width="240" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Vjft1lGObwCoVNcR9MzN-0" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="1000" as="sourcePoint" />
            <mxPoint x="540" y="1360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="1000" />
              <mxPoint x="600" y="1360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;text-align: center;&quot;&gt;&amp;nbsp;＜ initializeControlPlane ＞&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;Call cloneConfigsAndGenerateMachine based on&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・Cluster&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・KCP&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・KCP.Spec.KubeadmConfigSpec&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・KCP.Status.FaiureDomains&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L424-L428" id="Vjft1lGObwCoVNcR9MzN-3">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="550" y="1010" width="280" height="101" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&lt;div style=&quot;text-align: center;&quot;&gt;&amp;nbsp;＜ cloneConfigsAndGenerateMachine ＞&lt;/div&gt;&lt;div style=&quot;&quot;&gt;・Setup the data for Machine Resource&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・InfrastructureRef&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　　・from &lt;b&gt;KCP.Spec.MachineTemplate.InfrastructureRef&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;b&gt;　　&lt;/b&gt;・Generate &lt;b&gt;OpenStackMachine&lt;/b&gt; from &lt;b&gt;MachineTemplate&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・BootstrapRef&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　　・Generate &lt;b&gt;KubeadmConfigs&lt;/b&gt; on this setup&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;Call ＜ createMachine ＞ to create &lt;b&gt;Machine&lt;/b&gt; base on&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・Cluster&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・KCP&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・InfrastructureRef&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・BootstrapRef&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　・FailureDomains&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/helpers.go#L165" id="Vjft1lGObwCoVNcR9MzN-5">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="550" y="1125" width="340" height="220" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="Nm0rlJTsO2jQCJ_zU0Wj-1" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="Vjft1lGObwCoVNcR9MzN-5" target="g-v6_2hosOyxJWGCfkAE-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="820" y="1230" as="sourcePoint" />
            <mxPoint x="1290" y="1235" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Nm0rlJTsO2jQCJ_zU0Wj-2" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="Vjft1lGObwCoVNcR9MzN-5" target="31veatcvXabuM6n3mju--2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="840" y="1240" as="sourcePoint" />
            <mxPoint x="940" y="1290" as="targetPoint" />
            <Array as="points">
              <mxPoint x="635" y="1385" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="FFA2BmQDdDc9hQ9x6d-g-0" value="Reconcile &lt;b&gt;Machine&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="1950" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jT4cSPJMxtXF-6BDlFvC-0" value="Reconcile &lt;b&gt;KubeadmConfig&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1280" y="1270" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="IhIr9YV37j448sWCalq8-2" value="&lt;div&gt;&amp;nbsp;Let&lt;/div&gt;&lt;div&gt;&amp;nbsp;・infraRef = kcp.Spec.MachineTemplate.InfrastructureRef&lt;/div&gt;&lt;div&gt;&amp;nbsp; // Get the existing &lt;b&gt;OpenStackMachineTemplate&lt;/b&gt; resources&lt;/div&gt;&lt;div&gt;&amp;nbsp;・machineTemplate = Get(infraRef)&lt;/div&gt;&lt;div&gt;　 ・.Name = GenerateName(${machineTemplate.Name} + &quot;-&quot;)&lt;/div&gt;&lt;br&gt;&amp;nbsp;apiVersion: cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp;Kind: Machine&lt;br&gt;&amp;nbsp;metadata:&lt;br&gt;&amp;nbsp; &amp;nbsp;name : GenerateName(${kcp.Name} + &quot;-&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp;namespace : ${kcp.Namespace}&lt;br&gt;&amp;nbsp; &amp;nbsp;OwnerReferences:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- apiVersion: controlplane.cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kind: KubeadmControlPlane&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;name: ${kcp.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;uid: ${kcp.UID}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;blockOwnerDeletion: true&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;controller: true&lt;br&gt;&amp;nbsp;spec:&lt;br&gt;&amp;nbsp; &amp;nbsp;clusterName: $[cluster.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp;version: ${kcp.Spec.Version}&lt;br&gt;&amp;nbsp; &amp;nbsp;failureDomain: $[failureDomain}&lt;br&gt;&amp;nbsp; &amp;nbsp;infrastructureRef:&amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;apiVersion: ${machineTemplate.ApiVersion}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;kind: ${machineTemplate.Kind} - &quot;Template&quot; //&lt;b&gt; OpenStackMachine&lt;/b&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;name: ${machineTemplate.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;namespace: ${kcp.Namespace}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;uid: ${machineTemplate.UID}&lt;br&gt;&amp;nbsp; &amp;nbsp;bootstrap:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;configRef:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;apiVersion: bootstrap.cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kind: KubeadmConfig&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;name: GenerateName(${kcp.Name} + &quot;-&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;namespace: ${kcp.Namespace}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;uid: ${kcp.UID}" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="550" y="1410" width="380" height="520" as="geometry" />
        </mxCell>
        <mxCell id="IhIr9YV37j448sWCalq8-3" value="&amp;nbsp;metadata:&lt;br&gt;&amp;nbsp; &amp;nbsp;name : GenerateName(${kcp.Name} + &quot;-&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp;namespace : ${kcp.Namespace}&lt;br&gt;&amp;nbsp; &amp;nbsp;Lables:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- ${kcp.Spec.MachineTemplate.ObjectMeta.Labels}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- cluster.x-k8s.io/cluster-name: ${cluster.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- cluster.x-k8s.io/control-plane:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- cluster.x-k8s.io/control-plane-name: ${kcp.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp;Annotations:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- ${kcp.Spec.MachineTemplate.ObjectMeta.Annotations}&lt;br&gt;&amp;nbsp; &amp;nbsp;OwnerReferences:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- apiVersion: controlplane.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kind: KubeadmControlPlane&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;name: kcp.Name&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;uid: kcp.UID&lt;br&gt;&amp;nbsp;spec:&lt;br&gt;&amp;nbsp; &amp;nbsp;${kcp.Spec.KubeadmConfigSpec (JoinConfiguration is nil)}" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1190" y="910" width="343" height="291" as="geometry" />
        </mxCell>
        <mxCell id="IhIr9YV37j448sWCalq8-4" value="Let&lt;br&gt;&amp;nbsp;・infraRef = kcp.Spec.MachineTemplate.InfrastructureRef&lt;br&gt;&amp;nbsp; // Get the existing &lt;b&gt;OpenStackMachineTemplate&lt;/b&gt; resources&lt;br&gt;&amp;nbsp;・machineTemplate = Get(infraRef)&lt;br&gt;　 ・.Name = GenerateName(${machineTemplate.Name} + &quot;-&quot;)&lt;br&gt;&lt;br&gt;&amp;nbsp;apiVersion: ${machineTemplate.ApiVersion}&lt;br&gt;&amp;nbsp;kind: ${machineTemplate.Kind} - &quot;Template&quot; // &lt;b&gt;OpenStackMachine&lt;/b&gt;&lt;br&gt;&amp;nbsp;metadata:&lt;br&gt;&amp;nbsp; &amp;nbsp;name: ${machineTemplate.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp;namespace: ${kcp.NameSpace}&lt;br&gt;&amp;nbsp; &amp;nbsp;annotations:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- ${template.metadata.annotations}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- cluster.x-k8s.io/cloned-from-name: ${infraRef.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- cluster.x-k8is.io/cloned-from-groupkind: ${infraRef....}&lt;br&gt;&amp;nbsp; &amp;nbsp;ownerReferences:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- apiVersion:&amp;nbsp;controlplane.cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kind: KubeadmControlPlane&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Name: ${kcp.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;UID: ${kcp.UID}&lt;br&gt;&amp;nbsp;spec: ${machineTemplate.Spec}" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="150" y="876" width="370" height="310" as="geometry" />
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--0" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.25;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="550" y="1200" as="sourcePoint" />
            <mxPoint x="140" y="1200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--1" value="Reconcile &lt;b&gt;OpenStackMachine&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-140" y="1230" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--2" value="Create &lt;b&gt;Machine&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="1370" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--4" value="Create &lt;b&gt;OpenStackMachine&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-140" y="1186" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--6" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="141" y="1246" as="sourcePoint" />
            <mxPoint x="141" y="1360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="201" y="1246" />
              <mxPoint x="200" y="1360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Waiting for set&lt;br&gt;&lt;b&gt;OpenStackMachine.metadata.ownerReferences&lt;br&gt;&lt;/b&gt;to&amp;nbsp;&lt;b&gt;Machine&lt;br&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackmachine_controller.go#L93-L101" id="31veatcvXabuM6n3mju--5">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="150" y="1280" width="340" height="50" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--7" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;dashed=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="557" y="1742" as="sourcePoint" />
            <mxPoint x="508" y="1170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="508" y="1743" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--8" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;dashed=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" target="IhIr9YV37j448sWCalq8-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="640" y="1843" as="sourcePoint" />
            <mxPoint x="1184.855" y="945.01" as="targetPoint" />
            <Array as="points">
              <mxPoint x="990" y="1843" />
              <mxPoint x="990" y="945" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--9" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="939" y="2020" as="sourcePoint" />
            <mxPoint x="939" y="2085" as="targetPoint" />
            <Array as="points">
              <mxPoint x="999" y="2020" />
              <mxPoint x="999" y="2085" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--12" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2280" as="sourcePoint" />
            <mxPoint x="940" y="2370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="2280" />
              <mxPoint x="1000" y="2370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--13" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2400" as="sourcePoint" />
            <mxPoint x="940" y="2486" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="2400" />
              <mxPoint x="1000" y="2486" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="＜ reconcileBootstrap ＞&lt;br&gt;Set&amp;nbsp;&lt;font color=&quot;#0000ff&quot; style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;OwnerReference : Machine -(own)-&amp;gt; KubeadmConfigs&lt;/font&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L180" id="31veatcvXabuM6n3mju--15">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="949" y="2035" width="360" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&amp;nbsp;＜ reconcileInfrastructure ＞&lt;br&gt;Waiting for&lt;br&gt;&lt;b&gt;OpenStackMachine.Status.Ready&amp;nbsp;&lt;/b&gt;is&lt;b&gt; True&lt;br&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L290-L294" id="31veatcvXabuM6n3mju--16">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="2290" width="340" height="62" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&amp;nbsp;＜ reconcileNode ＞&lt;br&gt;Waiting for Set&lt;br&gt;&lt;b&gt;Machine.Spec.ProviderID&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_noderef.go#L56-L61" id="31veatcvXabuM6n3mju--17">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="2420" width="340" height="52" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--20" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1540" y="2510" as="sourcePoint" />
            <mxPoint x="940" y="2510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--21" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2250" as="sourcePoint" />
            <mxPoint x="140" y="2250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--22" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2100" as="sourcePoint" />
            <mxPoint x="1540" y="2100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--28" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2110" as="sourcePoint" />
            <mxPoint x="939" y="2170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="2110" />
              <mxPoint x="999" y="2170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="＜ reconcileBootstrap ＞&lt;br&gt;Waiting for&amp;nbsp;&lt;b&gt;KubeadmConfig.Status.Ready &lt;/b&gt;is&lt;b&gt; True&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L220-L224" id="31veatcvXabuM6n3mju--26">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="949" y="2120" width="461" height="39" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--32" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1540" y="1285" as="sourcePoint" />
            <mxPoint x="1540" y="1380" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1600" y="1285" />
              <mxPoint x="1600" y="1380" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;Waiting for set&lt;br&gt;&lt;b&gt;KubeadmConfig.metadata.ownerReferences&lt;/b&gt;&lt;br&gt;to &lt;b&gt;Machine&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go#L161-L166" id="31veatcvXabuM6n3mju--31">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="1553" y="1299" width="280" height="61" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--33" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1540" y="2100" as="sourcePoint" />
            <mxPoint x="1540" y="2510" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1600" y="2100" />
              <mxPoint x="1600" y="2510" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;text-align: center;&quot;&gt;&amp;nbsp;＜ handleClusterNotInitialized ＞&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;Parepare&amp;nbsp;&lt;b&gt;Secret&lt;/b&gt;&amp;nbsp;data that contains following &lt;a href=&quot;https://cloudinit.readthedocs.io/en/latest/&quot;&gt;Cloud-Init&lt;/a&gt; or &lt;a href=&quot;https://www.flatcar.org/docs/latest/provisioning/ignition/specification/&quot;&gt;Ignition&lt;/a&gt; contents&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;・Certificates&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;・kubeadm.yaml (See &lt;a href=&quot;https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta4/&quot;&gt;kubeadm configuration&lt;/a&gt;)&lt;/div&gt;&lt;div style=&quot;&quot;&gt;　 ・InitConfiguration&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;　・ClusterConfiguration&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;　・runcmd: kubeadm init --config /run/kubeadm/kubeadm.yaml&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go#L286-L289" id="31veatcvXabuM6n3mju--34">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="1553" y="2160" width="427" height="120" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="31veatcvXabuM6n3mju--31" target="31veatcvXabuM6n3mju--31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="31veatcvXabuM6n3mju--37" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1540" y="2540" as="sourcePoint" />
            <mxPoint x="1540" y="2620" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1600" y="2540" />
              <mxPoint x="1600" y="2620" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;&quot;&gt;&amp;nbsp;＜ ensureBootstrapSecretOwnerRef ＞&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;Set &lt;font color=&quot;#0000ff&quot;&gt;OwnerReference KubeadmConfig -(own) -&amp;gt; Secret&lt;/font&gt;&lt;/div&gt;" id="31veatcvXabuM6n3mju--38">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="1553" y="2550" width="317" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&lt;div style=&quot;text-align: center;&quot;&gt;&amp;nbsp;＜ storeBootstrapData ＞&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・Generate Secret resource from above data&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;・Set &lt;b&gt;KubeadmConfig.Status.DataSecretName&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;・Set &lt;b&gt;KubeadmConfig.Status.Ready&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp;・Set &lt;b&gt;KubeadmConfig.Status.Conditions&lt;/b&gt; (&lt;b&gt;DataSecretAvailable&lt;/b&gt; is True)&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go#L522-L525" id="31veatcvXabuM6n3mju--42">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="1553" y="2290" width="427" height="80" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--44" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2185" as="sourcePoint" />
            <mxPoint x="940" y="2250" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="2185" />
              <mxPoint x="1000" y="2250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ reconcileInfrastructure ＞&lt;br&gt;Set&amp;nbsp;&lt;font color=&quot;#0000ff&quot; style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;OwnerReference : Machine -(own)-&amp;gt; OpenStackMachine&lt;/font&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L247-L248" id="31veatcvXabuM6n3mju--43">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="2200" width="360" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--46" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="141" y="2273" as="sourcePoint" />
            <mxPoint x="140" y="2360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="201" y="2273" />
              <mxPoint x="200" y="2360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Waiting for set&lt;br&gt;&lt;b&gt;Machine.Spec.Bootstrap.DataSecretName&lt;br&gt;&lt;/b&gt;Machine is retrieved from the owner of OpenStackMachine" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackmachine_controller.go#L316-L321" id="31veatcvXabuM6n3mju--47">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="150" y="2290" width="360" height="50" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--48" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2530" as="sourcePoint" />
            <mxPoint x="940" y="2630" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="2530" />
              <mxPoint x="1000" y="2630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="＜ reconcileBootstrap ＞&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;Machine.Spec.Bootstrap.DataSecretName&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt; =&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt; KubeadmConfig.Status.DataSecretName&lt;/b&gt;&lt;/div&gt;&lt;b&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;Machine.Status.BootstrapReady = true&lt;/b&gt;&lt;/div&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L227-L233" id="31veatcvXabuM6n3mju--49">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="2540" width="490" height="80" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="31veatcvXabuM6n3mju--52" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2630" as="sourcePoint" />
            <mxPoint x="140" y="2630" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fxvNcrM4MveXy_DPgTpj-0" value="Legends&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;Bold&lt;/b&gt;&amp;nbsp;: The Kubernetes Resource Data&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;Blue&lt;/font&gt;&amp;nbsp;: The relationship between Kubernetes Resources&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;lt; Func &amp;gt; : The function name&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Rounded rectangle is basically has hyperlink to the actual code ( please click )&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-600" y="43" width="455" height="127" as="geometry" />
        </mxCell>
        <mxCell id="dfYB85Jv6Tvpu-4wAcZJ-0" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="141" y="2640" as="sourcePoint" />
            <mxPoint x="140" y="2860" as="targetPoint" />
            <Array as="points">
              <mxPoint x="201" y="2640" />
              <mxPoint x="200" y="2860" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="　Get CloudInit data from &lt;b&gt;Secret&lt;/b&gt; that name is provided from Machine.Spec.Bootstrap.DataSecretName&lt;br&gt;&lt;div&gt;　Create VM by openstack&lt;/div&gt;&lt;div&gt;　&amp;nbsp; - Spec data are provided from &lt;b&gt;OpenStackCluster&lt;/b&gt;, &lt;b&gt;OpenStackMachine&lt;/b&gt;, &lt;b&gt;Machine &lt;/b&gt;and above&amp;nbsp;CloudInit&lt;/div&gt;&lt;div&gt;　&amp;nbsp; - Construct Network as needed&lt;/div&gt;&lt;div&gt;　Get instance status （polling VM bootstrap）&lt;/div&gt;&lt;div&gt;　Update status&lt;/div&gt;&lt;div&gt;&lt;div&gt;　&amp;nbsp; &lt;b&gt;OpenStackMachine.Spec.ProviderID = fmt.Sprintf(&quot;openstack:///%s&quot;, instanceStatus.ID())&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;　&amp;nbsp; OpenStackMachine.Spec.InstanceID = instanceStatus.ID()&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;　&amp;nbsp; OpenStackMachine.Status.InstnaceState = instanceStatus.State()&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;　&amp;nbsp; OpenStackMachine.Status.Address = &amp;lt;instnace address&amp;gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;　&amp;nbsp; OpenStackMachine.Status.Ready = true&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/main/controllers/openstackmachine_controller.go#L313-L443" id="dfYB85Jv6Tvpu-4wAcZJ-1">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="-110" y="2657" width="600" height="183" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="dfYB85Jv6Tvpu-4wAcZJ-3" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="2880" as="sourcePoint" />
            <mxPoint x="940" y="2880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="dfYB85Jv6Tvpu-4wAcZJ-4" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="2880" as="sourcePoint" />
            <mxPoint x="940" y="3030" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="2880" />
              <mxPoint x="1000" y="3030" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ reconcileInfrastructure ＞&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;Machine.Status.InfrastructureReady = OpenStackMachine.Status.Ready&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;Machine.Spec.ProviderID =&lt;/b&gt; &lt;b&gt;OpenStackMachine.Spec.ProviderID&lt;/b&gt;&lt;/div&gt;&lt;b&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;Machine.Status.Addresses = OpenStackMachine.Status.Addresses&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;Machine.Spec.FailureDomain = OpenStackMachine.Status.FailureDomain&lt;/b&gt;&lt;/div&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L274-L321" id="dfYB85Jv6Tvpu-4wAcZJ-5">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="950" y="2900" width="480" height="110" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="dfYB85Jv6Tvpu-4wAcZJ-6" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="939" y="3220" as="sourcePoint" />
            <mxPoint x="939" y="3500" as="targetPoint" />
            <Array as="points">
              <mxPoint x="999" y="3220" />
              <mxPoint x="999" y="3500" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ reconcileNode ＞&lt;br&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;Get workload cluster client&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span&gt;Get workload node that has &lt;/span&gt;&lt;b&gt;Node.Spec.ProviderID&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;Machine.Status.NodeRef = &amp;lt;Workload Node&amp;gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;Machine.Status.NodeInfo = node.Status.NodeInfo&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;Node.Metadata.Annotations&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp; - cluster.x-k8s.io/cluster-name = &lt;b&gt;Machine.Spec.ClusterName&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp; - cluster.x-k8s.io/cluster-namespace = &lt;b&gt;Machine.Metadata.Namespace&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp; - cluster.x-k8s.io/machine = &lt;b&gt;Machine.Metadata.Name&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp; -&amp;nbsp;cluster.x-k8s.io/owner-kind = &lt;b&gt;Machine.Metadata.OwnerReferences.Kind (KubeadmControlPlane)&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp; -&amp;nbsp;cluster.x-k8s.io/owner-name = &lt;b&gt;Machine.Metadata.OwnerReferences.Name&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;Check &lt;b&gt;Node.Status.Conditions&lt;/b&gt; semantically a&lt;span style=&quot;background-color: initial;&quot;&gt;nd if node condition is healty, then&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;Machine.Status.Conditions = NodeHealty&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_noderef.go#L63-L157" id="dfYB85Jv6Tvpu-4wAcZJ-7">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="809" y="3234" width="630" height="246" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="dfYB85Jv6Tvpu-4wAcZJ-9" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="939" y="4110" as="sourcePoint" />
            <mxPoint x="939" y="4270" as="targetPoint" />
            <Array as="points">
              <mxPoint x="999" y="4110" />
              <mxPoint x="999" y="4270" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ reconcileCertificateExpiry ＞&lt;br&gt;&lt;div style=&quot;text-align: left&quot;&gt;Process following logic If the machine is control plane&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;Check if &lt;b&gt;Machine.Metadata.Annotations&lt;/b&gt; has 「&lt;span style=&quot;background-color: initial;&quot;&gt;machine.cluster.x-k8s.io/certificates-expiry」&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp;=&amp;gt; Set &lt;b&gt;Machine.Status.CertificatesExpiryDate&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;else if &lt;b&gt;KubeadmConfig.Metadata.Annotations&lt;/b&gt; has 「machine.cluster.x-k8s.io/certificates-expiry」&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&amp;nbsp;=&amp;gt; Set &lt;b&gt;Machine.Status.CertificatesExpiryDate&lt;/b&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L325" id="dfYB85Jv6Tvpu-4wAcZJ-10">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="809" y="4127" width="640" height="130" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="oCrjSo22_eZG0TeXv7a6-0" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.995;exitY=0.543;exitDx=0;exitDy=0;exitPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-181.6500000000001" y="3221.902" as="sourcePoint" />
            <mxPoint x="940" y="3220" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="oCrjSo22_eZG0TeXv7a6-6" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="939" y="4290" as="sourcePoint" />
            <mxPoint x="939" y="4391" as="targetPoint" />
            <Array as="points">
              <mxPoint x="999" y="4290" />
              <mxPoint x="999" y="4391" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;＜ reconcilePhase ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;b&gt;Machine.Status.NodeRef&lt;/b&gt; is not nil &amp;amp;&amp;amp;&lt;b&gt; Machine.Status.InfrastructureReady&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;=&amp;gt; &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;Machine.Status.Phase.Running&lt;/b&gt;&lt;/div&gt;" id="oCrjSo22_eZG0TeXv7a6-7">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="809" y="4305" width="660" height="70" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-0" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="790" as="sourcePoint" />
            <mxPoint x="540" y="910" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="790" />
              <mxPoint x="600" y="910" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;Generate following&lt;b&gt;&amp;nbsp;Secrets&lt;/b&gt;&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; ・&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;lt;ClusterName&amp;gt;-[ca | sa | etcd | proxy ]&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;text-align: center;&quot;&gt;&amp;nbsp;Set&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;OwnerReference :&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;&amp;nbsp;KubeadmControlPlane -(own)-&amp;gt; Secret&lt;/font&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L353-L356" id="ApD_89TyXpNjRMCBsfqb-1">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="550" y="800" width="240" height="100" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-5" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="539.5" y="2920" as="sourcePoint" />
            <mxPoint x="540" y="3210" as="targetPoint" />
            <Array as="points">
              <mxPoint x="599.5" y="2920" />
              <mxPoint x="600" y="3210" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;＜ reconcileControlPlaneConditions ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Get workload client and check the following pod status of all control-plane machine&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ kube-api-&amp;lt;control-plane-machine-name&amp;gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ kube-scheduler-&amp;lt;control-plane-machine-name&amp;gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ kube-controller-manager-&amp;lt;control-plane-machine-name&amp;gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ etcd-&amp;lt;control-plane-machine-name&amp;gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;If pod status is &#39;Running&#39;, then mark the machine conditions as True&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ &lt;b&gt;APIServerPodHealty&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ &lt;b&gt;SchedulerPodHealty&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ &lt;b&gt;ControllerManagerPodHealty&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;・ &lt;b&gt;EtcdPodHealty&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;And also checks whether the etcd members are expected or not.&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;If expected, then mark the machine condition &#39;&#39;&lt;b&gt;EtcdMemberHealty&lt;/b&gt;&quot; as True&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;and the machine condition &quot;&lt;b&gt;EtcdClusterHealty&lt;/b&gt;&quot; as True&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L382-L384" id="ApD_89TyXpNjRMCBsfqb-6">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="390" y="2931" width="450" height="269" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="ApD_89TyXpNjRMCBsfqb-6" target="ApD_89TyXpNjRMCBsfqb-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-10" value="" style="endArrow=classic;html=1;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="3500" as="sourcePoint" />
            <mxPoint x="540" y="3500" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-12" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="539.5" y="3510" as="sourcePoint" />
            <mxPoint x="540" y="3590" as="targetPoint" />
            <Array as="points">
              <mxPoint x="599.5" y="3510" />
              <mxPoint x="600" y="3590" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;＜ reconcileEtcdMembers ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Get workload client and reconcile etcd for all control-plane node&#39;s etcd.&lt;/span&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L388-L390" id="ApD_89TyXpNjRMCBsfqb-13">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="390" y="3521" width="450" height="59" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-16" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="539.5" y="3660" as="sourcePoint" />
            <mxPoint x="540" y="3800" as="targetPoint" />
            <Array as="points">
              <mxPoint x="599.5" y="3660" />
              <mxPoint x="600" y="3800" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;＜ UpdateKubeProxyImageInfo ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;Get version tag from &lt;b&gt;kcp.Spec.Version&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;and Update the kube-proxy&#39;s container r&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;egistry image tag.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp;The responsibility for deploying kube-proxy lies with kubeadm.&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp;This process is responsible for changing the image version in accordance with kcp updates.&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L460-L464" id="ApD_89TyXpNjRMCBsfqb-17">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="390" y="3670" width="530" height="119" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="numMachines = desiredReplicas" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L440" id="ApD_89TyXpNjRMCBsfqb-19">
          <mxCell style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="435" y="3610" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-21" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="3810" as="sourcePoint" />
            <mxPoint x="540" y="4060" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="3810" />
              <mxPoint x="600" y="4060" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;＜ UpdateCoreDNS ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Get CoreDNS related informations needed for the upgrade&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;If kcp.Spec.kubeadmConfigSpec.clusterConfiguration.dns.imageTag is defined&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;and&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;different from current tag, then execute following functions&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;・updateCoreDNSImageInfoInKubeadmConfigMap&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; - Update &lt;b&gt;ConfigMap.Data&lt;/b&gt;&#39;s &lt;b&gt;ClusterConfiguration.DNS.ImageRepository&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; - Update &lt;b&gt;ConfigMap.Data&lt;/b&gt;&#39;s &lt;b&gt;ClusterConfiguration.DNS.ImageTag&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;・updateCoreDNSCorefile&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; - Migrate coredns corefile&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;・updatecoreDNSDeployment&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; - Patch CoreDNS deployment image, ...etc&lt;/span&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L466-L469" id="ApD_89TyXpNjRMCBsfqb-22">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;fontStyle=0" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="390" y="3820" width="530" height="230" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="ApD_89TyXpNjRMCBsfqb-24" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="4112" as="sourcePoint" />
            <mxPoint x="540" y="4240" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="4112" />
              <mxPoint x="600" y="4240" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ reconcileCertificateExpiries ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;If KubeadmConfig.Metradata.Annotations doesn&#39;t have&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;「&lt;b&gt;machine.cluster.x-k8s.io/certificates-expiry&lt;/b&gt;」,&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;then set the expiry date&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;retrieved from workload cluster&#39;s kube-apiserver&lt;/span&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/controller.go#L475C1-L478" id="ApD_89TyXpNjRMCBsfqb-26">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="390" y="4127" width="390" height="93" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="wAwyFI6jxsucVhHPXKm--2" value="openstack-cloud-controller-manager&lt;br&gt;（external cloud-provider)&lt;br&gt;&lt;br&gt;Provides &lt;b&gt;Node.Spec.ProviderID&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-480" y="3180" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="wAwyFI6jxsucVhHPXKm--5" value="&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Get &lt;b&gt;Machine&lt;/b&gt; information from &lt;b&gt;OpenStackMachine.Metadata.OwnerReferences&lt;/b&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Get &lt;b&gt;Secret&lt;/b&gt; from &lt;b&gt;Machine.Spec.Bootstrap.DataSecretName&lt;/b&gt; （This secret contains the contents of cloudinit）&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Try to get instance, and if the instance not found, then create it.&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Call ＜ machineToInstanceSpec ＞ function with &lt;b&gt;OpenStackCluster&lt;/b&gt;, &lt;b&gt;Machine&lt;/b&gt;, &lt;b&gt;OpenStackMachine&lt;/b&gt;, and userData (cloudinit) &lt;b&gt;Secret&lt;/b&gt; to create instance spec data.&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - Basically, spec data is derived from &lt;b&gt;OpenstackMachine.Spec&lt;/b&gt;&lt;br&gt;&amp;nbsp; - UserData from &lt;b&gt;Secret&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - instanceSpec.FailureDomain = &lt;b&gt;Machine.Spec.FailureDomain&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - instanceSpec.Tags = uniq(&lt;b&gt;OpenStackMachine.Spec.Tags&lt;/b&gt; + &lt;b&gt;OpenStackCluster.Spec.Tags&lt;/b&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - instanceSpec.SecurityGroups = &lt;b&gt;OpenStackMachine.Spec.SecuriyGroups&lt;/b&gt; + &lt;b&gt;OpenStackCluster.Spec&lt;/b&gt;.....&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - instanceSpec.Networks = &lt;b&gt;OpenStackMachine.Spec.Networks&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - instanceSpec.Ports = &lt;b&gt;OpenStackMachine.Spec.Ports&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;Call ＜ CreateInstance ＞ function with &lt;b&gt;OpenStackMachine&lt;/b&gt;, &lt;b&gt;OpenStackCluster&lt;/b&gt;, instanceSpec, cluster.Name&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - Get imageID from instanceSpec.ImageUUID or instanceSpec.Image&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - Get flavorID from instanceSpec.Flavor&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - Call ＜ constructNetworks ＞&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - Get security group from instanceSpec.SecurityGroup&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - Handle port, fixedIP from the result of constructNetworks&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - Get root volume from &lt;b&gt;OpenStackMachine.Spec.RootVolume&lt;/b&gt;,&amp;nbsp; if missing, create image.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp; - Construct CreateOps struct and call ＜ CreateServer ＞ function to create instance.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Polling and monitoring the status until the Instance becomes ACTIVE（with retry and timeout）&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;The result of Polling is obtained as an instanceStatus struct&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Update spec and status as follows&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - &lt;b&gt;OpenStackMachine.Spec.ProviderID&lt;/b&gt; = fmt.Sprintf(&quot;openstack:///%s&quot;, instanceStatus.ID())&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - &lt;b&gt;OpenStackMachine.Spec.InstanceID&lt;/b&gt; = instanceStatus.ID()&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - &lt;b&gt;OpenStackMachine.Status.InstnaceState&lt;/b&gt; = instanceStatus.State()&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - &lt;b&gt;OpenStackMachine.Status.Address&lt;/b&gt; = &amp;lt;instnace address&amp;gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;If instanceStatus.State() is &quot;ACTIVE&quot;, then set the condition &quot;&lt;b&gt;InstanceReady&lt;/b&gt;&quot; to &lt;b&gt;OpenStackMachine&lt;/b&gt;.&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;The case that created instance is for worker node (not for control plane), return this function as &quot;Reconciled machine create successfully&quot;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;If the created instance is for control plane, then need to handle LoadBalancer, floating IP related logic.&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Case : &lt;b&gt;OpenStackCluster.Spec.APIServerLoadBalancer.Enabled&lt;/b&gt; is True&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - Call ＜ reconcileLoadBalancerMember ＞ function&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - If the result of calling above function is err, then mark &quot;&lt;b&gt;APIServerIngressReadyCondition&lt;/b&gt;&quot; is False and the reason is ”&lt;b&gt;LoadBalancerMemberError&lt;/b&gt;”&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - Otherwise &quot;&lt;b&gt;APIServerIngressReadyCondition&lt;/b&gt;&quot; is True&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Case : &lt;b&gt;OpenStackCluster.Spec.APIServerLoadBalancer.Enabled&lt;/b&gt; is False and &lt;b&gt;OpenStackCluster.Spec.DisableAPIServerFloatingIP&lt;/b&gt; is False&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - If &lt;b&gt;OpenStackCluster.Spec.APIServerFloatingIP&lt;/b&gt; is defined then use it as floating ip address, otherwise &lt;b&gt;OpenstackCluster.Spec.ControlPlaneEndpoint.Host&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - Get or create flaoting IP address （openstack neutron）&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - Get management or external port for instance, and associate floating IP address and port.&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - All of above logic are succeeded, then mark the condition of &lt;b&gt;OpenStackCluster&lt;/b&gt;&#39;s&amp;nbsp; &quot;&lt;b&gt;APIServerIngressReadyCondition&lt;/b&gt;&quot; is True&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Case : OpenStackCluster.Spec.DisableAPIServerFloatingIP is True&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - Skip above condition related logic&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;nbsp; - And &quot;&lt;b&gt;APIServerIngressReadyCondition&lt;/b&gt;&quot; is True&lt;/div&gt;" style="shape=card;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-800" y="1840" width="880" height="780" as="geometry" />
        </mxCell>
        <mxCell id="XpJ4l908Trm4dATRl4G8-0" value="" style="endArrow=oval;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;endFill=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="dfYB85Jv6Tvpu-4wAcZJ-1" target="wAwyFI6jxsucVhHPXKm--5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-160" y="2760" as="sourcePoint" />
            <mxPoint x="-330" y="2630" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-360" y="2749" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="XpJ4l908Trm4dATRl4G8-1" value="Detail" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="XpJ4l908Trm4dATRl4G8-0" connectable="0" vertex="1">
          <mxGeometry x="0.6931" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YPATx5BZAxsaN8F7LSnj-3" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="1965" as="sourcePoint" />
            <mxPoint x="940" y="2010" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="1965" />
              <mxPoint x="1000" y="2010" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ Reconcile ＞&lt;br&gt;Machine.Metadata.Label[&quot;cluster.x-k8s.io/cluster-name&quot;] = &quot;&amp;lt;ClusterName&amp;gt;&quot;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L141-L142" id="YPATx5BZAxsaN8F7LSnj-4">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
            <mxGeometry x="959" y="1960" width="441" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="NEyGXR4sjAseoX5JXWXM-0" value="　In the sequence of 「kubeadm init」in VM,&lt;br&gt;kubeadm create 「kubeadm-config」ConfigMap&lt;br&gt;to it&#39;s kubernetes cluster（workload cluster）." style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-510" y="4430" width="300" height="100" as="geometry" />
        </mxCell>
        <mxCell id="NEyGXR4sjAseoX5JXWXM-2" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="NEyGXR4sjAseoX5JXWXM-0">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="130" y="4360" as="sourcePoint" />
            <mxPoint x="540" y="4480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="NEyGXR4sjAseoX5JXWXM-6" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="4480" as="sourcePoint" />
            <mxPoint x="540" y="4608" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="4480" />
              <mxPoint x="600" y="4608" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ ClusterStatus ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Check if&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;1. Number of Ready Nodes in WorkloadCluster&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;2. Existence of 「kubeadm-config」ConfigMap in WorkloadCluster&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/workload_cluster.go#L403" id="NEyGXR4sjAseoX5JXWXM-4">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
            <mxGeometry x="370" y="4500" width="390" height="93" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="NEyGXR4sjAseoX5JXWXM-9" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="4620" as="sourcePoint" />
            <mxPoint x="540" y="4760" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="4620" />
              <mxPoint x="600" y="4760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ updateStatus ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;a href=&quot;https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/status.go#L96-L99&quot;&gt;If 「kubeadm-config」ConfigMap exists&lt;/a&gt; in WorkloadCluster,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;then &lt;b&gt;KCP.Status.Initialized = true&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;a href=&quot;https://github.com/kubernetes-sigs/cluster-api/blob/main/controlplane/kubeadm/internal/controllers/status.go#L101-L103&quot;&gt;If the number of ready nodes in WorkloadCluster is upper than 0&lt;/a&gt;,&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;then&lt;b&gt; KCP.Status.Ready = true&lt;/b&gt;&lt;/div&gt;" id="NEyGXR4sjAseoX5JXWXM-7">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
            <mxGeometry x="370" y="4630" width="390" height="120" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="NEyGXR4sjAseoX5JXWXM-10" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="4780" as="sourcePoint" />
            <mxPoint x="940" y="4780" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uMIeRt8Mf4V_QBngPhR1-0" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="940" y="4780" as="sourcePoint" />
            <mxPoint x="940" y="4920" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1000" y="4780" />
              <mxPoint x="1000" y="4920" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;＜ reconcileControlPlane ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Set status to&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;Cluster.Status.ControlPlaneReady = true&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-weight: bold; text-align: left;&quot;&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;Cluster.Status.ControlPlaneInitializedCondition&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-weight: bold; text-align: left;&quot;&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;Cluster.Status.ControlPlaneReadyCondition&lt;/b&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller_phases.go#L251-L275" id="NEyGXR4sjAseoX5JXWXM-11">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
            <mxGeometry x="820" y="4800" width="340" height="100" as="geometry" />
          </mxCell>
        </UserObject>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="K-nK02OO9YTbBZ2laZoO" name="c-plane_resource-controller-relation">
    <mxGraphModel dx="2375" dy="873" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="C33fGPlAHL-XZ4_2fAEm-1" value="" style="rounded=0;whiteSpace=wrap;html=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="-477" y="240" width="160" height="140" as="geometry" />
        </mxCell>
        <mxCell id="C33fGPlAHL-XZ4_2fAEm-10" value="Watches :&amp;nbsp;&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-468" y="340" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="C33fGPlAHL-XZ4_2fAEm-5" value="For :&amp;nbsp;&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-440" y="280" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="C33fGPlAHL-XZ4_2fAEm-9" value="Owns :&amp;nbsp;&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-453" y="310" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-5" value="cluster.x-k8s.io/v1beta1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="-310" y="580" width="450" height="140" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-4" value="bootstrap.cluster.x-k8s.io/v1beta1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="414" y="580" width="210" height="140" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-3" value="infrastructure.cluster.x-k8s.io/v1beta1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="660" y="580" width="450" height="140" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-2" value="controlplane.cluster.x-k8s.io/v1beta1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="170" y="580" width="210" height="140" as="geometry" />
        </mxCell>
        <mxCell id="VxDLtMB8CeQsxy4SgELT-2" value="clusterv1.Cluster" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="-270" y="610" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="VxDLtMB8CeQsxy4SgELT-4" value="clusterv1.Machine" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="-60" y="610" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="2rQUpRiCxdTRnuSMDM04-3" value="controlplanev1.&lt;br&gt;KubeadmControlPlane" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="190" y="610" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UuFq6a8TQvATmrFzlLJg-3" value="bootstrapv1.KubeadmConfig" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="434" y="615" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-7" value="capi-kubeadm-control-plane&lt;br&gt;controller-manager" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="170" y="200" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-10" value="capo&lt;br&gt;controller-manager" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="780" y="200" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-11" value="capi-kubeadm-bootstrap&lt;br&gt;controller-manager" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="414" y="200" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="v4q6QumTbdKKYk-VR1ti-12" value="capi&lt;br&gt;controller-manager" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-190" y="200" width="210" height="60" as="geometry" />
        </mxCell>
        <UserObject label="KubeadmControlePlaneReconciler" id="yslnzAdHvYgu-CmDP0dG-6">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="170" y="260" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="OpenStackClusterReconciler" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackcluster_controller.go#L570-L609" id="yslnzAdHvYgu-CmDP0dG-21">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="676.5" y="260" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="OpenStackMachineReconciler" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackmachine_controller.go#L192-L225" id="yslnzAdHvYgu-CmDP0dG-22">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="886.5" y="260" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-23" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shape=flexArrow;" parent="1" source="yslnzAdHvYgu-CmDP0dG-21" target="yslnzAdHvYgu-CmDP0dG-24" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="529" y="300" as="sourcePoint" />
            <mxPoint x="780" y="510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-12" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.429;exitY=0.498;exitDx=0;exitDy=0;shape=flexArrow;exitPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-400.00000000000006" y="294.69999999999993" as="sourcePoint" />
            <mxPoint x="-340.09" y="294.66" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-24" value="infrav1.OpenStackCluster" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="696.5" y="610" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-13" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-401" y="324" as="sourcePoint" />
            <mxPoint x="-341" y="324" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-25" value="infrav1.OpenStackMachine" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="906.5" y="610" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-14" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-400" y="353" as="sourcePoint" />
            <mxPoint x="-340" y="353" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-26" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shape=flexArrow;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="yslnzAdHvYgu-CmDP0dG-22" target="yslnzAdHvYgu-CmDP0dG-25" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="792" y="300" as="sourcePoint" />
            <mxPoint x="792" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <UserObject label="KubeadmConfigReconciler" id="yslnzAdHvYgu-CmDP0dG-15">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="414" y="260" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="KubeadmConfigReconciler" id="yslnzAdHvYgu-CmDP0dG-27">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="414" y="260" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-18" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;shape=flexArrow;" parent="1" source="yslnzAdHvYgu-CmDP0dG-15" target="UuFq6a8TQvATmrFzlLJg-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="320" as="sourcePoint" />
            <mxPoint x="500" y="640" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-28" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shape=flexArrow;" parent="1" source="yslnzAdHvYgu-CmDP0dG-6" target="2rQUpRiCxdTRnuSMDM04-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="340" as="sourcePoint" />
            <mxPoint x="380" y="660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-29" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shape=flexArrow;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="yslnzAdHvYgu-CmDP0dG-27" target="UuFq6a8TQvATmrFzlLJg-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="285" y="300" as="sourcePoint" />
            <mxPoint x="285" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-31" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="yslnzAdHvYgu-CmDP0dG-6" target="VxDLtMB8CeQsxy4SgELT-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="270" y="290" as="sourcePoint" />
            <mxPoint x="120" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-32" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;" parent="1" source="yslnzAdHvYgu-CmDP0dG-6" target="VxDLtMB8CeQsxy4SgELT-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="240" y="320" as="sourcePoint" />
            <mxPoint x="45" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-33" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.525;entryY=-0.013;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;" parent="1" source="yslnzAdHvYgu-CmDP0dG-27" target="VxDLtMB8CeQsxy4SgELT-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="295" as="sourcePoint" />
            <mxPoint x="260" y="615" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-34" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;" parent="1" source="yslnzAdHvYgu-CmDP0dG-27" target="VxDLtMB8CeQsxy4SgELT-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="295" as="sourcePoint" />
            <mxPoint x="20" y="615" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-35" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" target="VxDLtMB8CeQsxy4SgELT-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="781" y="290" as="sourcePoint" />
            <mxPoint x="70" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-37" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.53;entryY=0.031;entryDx=0;entryDy=0;dashed=1;entryPerimeter=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="yslnzAdHvYgu-CmDP0dG-22" target="VxDLtMB8CeQsxy4SgELT-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="791" y="300" as="sourcePoint" />
            <mxPoint x="-195" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-38" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" target="VxDLtMB8CeQsxy4SgELT-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="990" y="290" as="sourcePoint" />
            <mxPoint x="-185" y="630" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-39" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="990" y="290" as="sourcePoint" />
            <mxPoint x="780" y="610" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <UserObject label="ClusterReconciler" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller.go#L80-L88" id="yslnzAdHvYgu-CmDP0dG-40">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="-290" y="260" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="MachineReconciler" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller.go#L108-L125" id="yslnzAdHvYgu-CmDP0dG-41">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="-80" y="260" width="210" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-42" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shape=flexArrow;" parent="1" source="yslnzAdHvYgu-CmDP0dG-40" target="VxDLtMB8CeQsxy4SgELT-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-130" y="330" as="sourcePoint" />
            <mxPoint x="-130" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-43" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shape=flexArrow;" parent="1" source="yslnzAdHvYgu-CmDP0dG-41" target="VxDLtMB8CeQsxy4SgELT-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-175" y="300" as="sourcePoint" />
            <mxPoint x="-175" y="620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-44" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="yslnzAdHvYgu-CmDP0dG-40" target="VxDLtMB8CeQsxy4SgELT-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="285" y="300" as="sourcePoint" />
            <mxPoint x="-60" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yslnzAdHvYgu-CmDP0dG-45" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="yslnzAdHvYgu-CmDP0dG-41" target="VxDLtMB8CeQsxy4SgELT-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-20" y="310" as="sourcePoint" />
            <mxPoint x="-100" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="C33fGPlAHL-XZ4_2fAEm-4" value="Legends" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-478" y="240" width="160" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="worker creation sequence diagram" id="ubkeo1JPcT1gt3zr0w1L">
    <mxGraphModel dx="3558" dy="1061" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="N3ns5-h5SZMH1uxuNw64-0" />
        <mxCell id="N3ns5-h5SZMH1uxuNw64-1" parent="N3ns5-h5SZMH1uxuNw64-0" />
        <UserObject label="capi-controller-manager" link="data:page/id,jB_KwWKISDssQRoUF651" id="N3ns5-h5SZMH1uxuNw64-4">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="440" y="40" width="200" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="capo-controller-manager&lt;br&gt;（cluster-api openstack provider）" link="data:page/id,1GsGqCXN8Yxk1cSTd2W0" id="N3ns5-h5SZMH1uxuNw64-5">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="-500" y="40" width="200" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="capi-kubeadm-bootstrap-controller-manager" link="data:page/id,9yOwVbE0o5gcLiuX17Gm" id="N3ns5-h5SZMH1uxuNw64-7">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="1440" y="40" width="200" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="N3ns5-h5SZMH1uxuNw64-8" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="N3ns5-h5SZMH1uxuNw64-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-410" y="100" as="sourcePoint" />
            <mxPoint x="-400" y="3950" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N3ns5-h5SZMH1uxuNw64-10" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="N3ns5-h5SZMH1uxuNw64-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="320" as="sourcePoint" />
            <mxPoint x="540" y="3010" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="N3ns5-h5SZMH1uxuNw64-11" value="" style="endArrow=classic;html=1;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="N3ns5-h5SZMH1uxuNw64-7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1550" y="90" as="sourcePoint" />
            <mxPoint x="1540" y="3950" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1540" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="N3ns5-h5SZMH1uxuNw64-18" value="Reconcile &lt;b&gt;MachineSet&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="190" y="1210" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="N3ns5-h5SZMH1uxuNw64-36" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="950" as="sourcePoint" />
            <mxPoint x="541" y="1180" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="950" />
              <mxPoint x="600" y="1180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="N3ns5-h5SZMH1uxuNw64-89" value="Legends&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;Bold&lt;/b&gt;&amp;nbsp;: The Kubernetes Resource Data&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;Blue&lt;/font&gt;&amp;nbsp;: The relationship between Kubernetes Resources&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&amp;lt; Func &amp;gt; : The function name&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;Rounded rectangle is basically has hyperlink to the actual code ( please click )&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="-980" y="43" width="455" height="127" as="geometry" />
        </mxCell>
        <mxCell id="RKa2VPBAodEblYbp8CD_-0" value="Create &lt;b&gt;MachineDeployment&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="240" y="100" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="RKa2VPBAodEblYbp8CD_-1" value="Reconcile &lt;b&gt;MachineDeployment&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="240" y="140" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="RKa2VPBAodEblYbp8CD_-2" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="156" as="sourcePoint" />
            <mxPoint x="540" y="230" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="156" />
              <mxPoint x="600" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Get &lt;b&gt;Cluster&lt;/b&gt; by &lt;b&gt;MachineDeployment.Spec.ClusterName&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/test/v1.5.2/internal/controllers/machinedeployment/machinedeployment_controller.go#L130" id="RKa2VPBAodEblYbp8CD_-3">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="170" width="340" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="MktLOzZsNGf30cCuDUol-0" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="250" as="sourcePoint" />
            <mxPoint x="540" y="324" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="250" />
              <mxPoint x="600" y="324" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Add label to &lt;b&gt;MachineDeployment&lt;/b&gt;&lt;br&gt;cluster.x-k8s.io/cluster-name: &lt;b&gt;MachineDeployment.Spec.ClusterName&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/test/v1.5.2/internal/controllers/machinedeployment/machinedeployment_controller.go#L206" id="MktLOzZsNGf30cCuDUol-1">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="480" y="264" width="410" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="r20XWvtAQbpBvJ-3QhCu-1" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="340" as="sourcePoint" />
            <mxPoint x="540" y="414" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="340" />
              <mxPoint x="600" y="414" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Set&amp;nbsp;&lt;font color=&quot;#0000ff&quot; style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; MachineDeployment&lt;/font&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/test/v1.5.2/internal/controllers/machinedeployment/machinedeployment_controller.go#L208-L214" id="r20XWvtAQbpBvJ-3QhCu-0">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="360" width="340" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-1" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="860" as="sourcePoint" />
            <mxPoint x="540" y="934" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="860" />
              <mxPoint x="600" y="934" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;Call ＜ rolloutRolling ＞ function&lt;br&gt;This function implements the logic for rolling a new MachineSet" link="https://github.com/kubernetes-sigs/cluster-api/blob/test/v1.5.2/internal/controllers/machinedeployment/machinedeployment_controller.go#L278" id="hPpHi9FJG0RTQSSKOcHU-2">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="870" width="370" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&amp;nbsp;Call ＜ getAllMachineSetsAndSyncRevision ＞ function in ＜ rolloutRoling＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;1. Call ＜ FindOldMachineSet ＞ function, but return empty oldMSs&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; because this is the initial deployment.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;2. Call ＜ getNewMachineSet ＞ function with createIfNotExists=True&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; In this function, Create a new &lt;b&gt;MachineSet&lt;/b&gt; by calling&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; ＜ createMachineSetAndWait ＞ function.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;3. Call ＜ updateMachineDeployment ＞ and set deployment revision.&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;4. return newMS, allOldMss（empty for the first time）, nil&lt;/span&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machinedeployment/machinedeployment_rolling.go#L34" id="hPpHi9FJG0RTQSSKOcHU-3">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="969" width="440" height="200" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-5" value="" style="endArrow=none;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" target="N3ns5-h5SZMH1uxuNw64-18" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="2700" as="sourcePoint" />
            <mxPoint x="410" y="1310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-6" value="" style="endArrow=classic;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" target="N3ns5-h5SZMH1uxuNw64-18" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="1180" as="sourcePoint" />
            <mxPoint x="410" y="1220" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-7" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="1195" as="sourcePoint" />
            <mxPoint x="540" y="1320" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="1195" />
              <mxPoint x="600" y="1320" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;Call ＜ reconcileNewMachineSet ＞ function in ＜ rolloutRoling＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;　Compare the values of newMS&#39;s replica and MD&#39;s replica,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; and if there is a difference, patch the value of newMS&#39;s to match the value of&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; Md&#39;s replica.&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machinedeployment/machinedeployment_rolling.go#L75" id="hPpHi9FJG0RTQSSKOcHU-8">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="1210" width="440" height="90" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-9" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="2250" as="sourcePoint" />
            <mxPoint x="540" y="2520" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="2250" />
              <mxPoint x="600" y="2520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Call ＜ syncDeploymentStatus ＞ function in ＜ rolloutRoling＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;1. Call ＜ calculateStauts ＞ and set &lt;b&gt;MD.Status&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - let availableReplicas = Sum(&lt;b&gt;MSs.Status.AvalableReplicas&lt;/b&gt;)&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - let totalReplicas = Sum(&lt;b&gt;MSs.Spec.Replicas&lt;/b&gt;)&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - let unavailableReplicas = totalReplicas - availableReplicas&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - Set the above values as &lt;b&gt;MD.Status&lt;/b&gt;.&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - If &lt;b&gt;MD.Spec.Replicas&lt;/b&gt; == Sum&lt;b&gt;(MSs.Status.ReadyReplicas&lt;/b&gt;) then &lt;b&gt;MD.Status.Phase = Running&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; else &lt;b&gt;MD.Status.Phase = ScalingUp&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;2. Calculate: minReplicasNeeded = md.Spec.Replicas - MaxUnavailable(MD), and&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;If &lt;b&gt;MD.Status.AvailableReplicas&lt;/b&gt; &amp;gt;= minReplicasNeeded&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - Add conditions type &quot;&lt;b&gt;Available&lt;/b&gt;&quot; and status is &quot;&lt;b&gt;True&lt;/b&gt;&quot;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;else （&lt;b&gt;MD.Status.AvailableReplicas&lt;/b&gt; &amp;lt; minReplicasNeeded）&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - Add conditions type &quot;&lt;b&gt;Available&lt;/b&gt;&quot; and status is &quot;False&quot; with the severity &quot;&lt;b&gt;Warning&lt;/b&gt;&quot; and some message.&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machinedeployment/machinedeployment_rolling.go#L53-L55" id="hPpHi9FJG0RTQSSKOcHU-10">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="2260" width="580" height="250" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-11" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="2539" as="sourcePoint" />
            <mxPoint x="540" y="2630" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="2539" />
              <mxPoint x="600" y="2630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Call ＜ reconcileOldMachineSets ＞ function in ＜ rolloutRoling＞&lt;br&gt;&lt;br&gt;Scale downs the Machine / MachineSet replicas if needed" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machinedeployment/machinedeployment_rolling.go#L57-L60" id="hPpHi9FJG0RTQSSKOcHU-12">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="2550" width="440" height="66" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-13" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="2650" as="sourcePoint" />
            <mxPoint x="540" y="2720" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="2650" />
              <mxPoint x="600" y="2720" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="（Re）Call ＜ syncDeploymentStatus ＞ function in ＜ rolloutRoling＞" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machinedeployment/machinedeployment_rolling.go#L62-L64" id="hPpHi9FJG0RTQSSKOcHU-14">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="2664" width="440" height="41" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-15" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="2740" as="sourcePoint" />
            <mxPoint x="540" y="2930" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="2740" />
              <mxPoint x="600" y="2930" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Call ＜ DeploymentComplete ＞ function in ＜ rolloutRoling＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Check the following conditions&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - newStatus.UpdatedReplicas == MD.Spec.Replicas&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - newStatus.Replicas = MD.Spec.Replicas&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - newStatus.AvailableReplicas == MD.Spec.Replicas&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; - newStatus.ObservedGeneration &amp;gt;= MD.Generation&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;And if all conditions are true, then trigger ＜ cleanupDeployment ＞&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machinedeployment/machinedeployment_rolling.go#L66-L70" id="hPpHi9FJG0RTQSSKOcHU-16">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="2755" width="440" height="155" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-17" value="" style="endArrow=classic;html=1;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="440" y="2250" as="sourcePoint" />
            <mxPoint x="540" y="2250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-19" value="" style="endArrow=oval;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.914;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" source="hPpHi9FJG0RTQSSKOcHU-14" target="hPpHi9FJG0RTQSSKOcHU-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1020" y="2689" as="sourcePoint" />
            <mxPoint x="1070" y="2639" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1080" y="2685" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-20" value="Detail" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hPpHi9FJG0RTQSSKOcHU-19" vertex="1" connectable="0">
          <mxGeometry x="0.2654" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-21" value="Create &lt;b&gt;MachineSet&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="240" y="1165" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-22" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="1290" as="sourcePoint" />
            <mxPoint x="500" y="1350" as="targetPoint" />
            <Array as="points">
              <mxPoint x="460" y="1290" />
              <mxPoint x="460" y="1350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Get &lt;b&gt;Cluster&lt;/b&gt; by &lt;b&gt;MachineSet.Spec.ClusterName&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machineset/machineset_controller.go#L151" id="hPpHi9FJG0RTQSSKOcHU-23">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="150" y="1300" width="340" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-24" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="1390" as="sourcePoint" />
            <mxPoint x="500" y="1450" as="targetPoint" />
            <Array as="points">
              <mxPoint x="460" y="1390" />
              <mxPoint x="460" y="1450" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Add label to &lt;b&gt;MachineSet&lt;/b&gt;&lt;br&gt;cluster.x-k8s.io/cluster-name: &lt;b&gt;MachineSet.Spec.ClusterName&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machineset/machineset_controller.go#L223" id="hPpHi9FJG0RTQSSKOcHU-25">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="80" y="1399" width="410" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-26" value="Let&lt;br&gt;&amp;nbsp;・name = computeNewMachineSetName(md.Name + &quot;-&quot;)&lt;br&gt;&amp;nbsp;・replicas = mdutils.NewMSNewReplicas(md, oldMSs, 0)&lt;br&gt;&amp;nbsp;・machineTemplateSpec = md.Spec.Template.Spec.DeepCopy()&lt;br&gt;&lt;br&gt;&amp;nbsp;apiVersion: cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp;kind: MachineSet&lt;br&gt;&amp;nbsp;metadata:&lt;br&gt;&amp;nbsp; &amp;nbsp;name: ${name}&lt;br&gt;&amp;nbsp; &amp;nbsp;namespace: ${md.NameSpace}&lt;br&gt;&amp;nbsp; &amp;nbsp;ownerReferences:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- apiVersion: cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kind: MachineDeployment&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Name: ${md.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;UID: ${md.UID}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;blockOwnerDeletion: true&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;controller: true&lt;br&gt;&amp;nbsp; &amp;nbsp;Finalizer: ${...}&lt;br&gt;&amp;nbsp;spec: &lt;br&gt;&amp;nbsp; &amp;nbsp;replicas: ${replicas}&lt;br&gt;&amp;nbsp; &amp;nbsp;clusterName: ${md.Spec.ClusterName}&lt;br&gt;&amp;nbsp; &amp;nbsp;template: &lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;spec: ${machineTemplateSpec}" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="1040" y="894" width="360" height="350" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-27" value="" style="endArrow=none;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;endFill=0;startArrow=oval;startFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" source="hPpHi9FJG0RTQSSKOcHU-26" target="hPpHi9FJG0RTQSSKOcHU-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="780" y="1110" as="sourcePoint" />
            <mxPoint x="830" y="1060" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-28" value="&amp;nbsp;Recall )&lt;br&gt;&amp;nbsp;&lt;br&gt;&amp;nbsp;machineTemplateSpec =&amp;nbsp;&amp;nbsp;md.Spec.Template.Spec.DeepCopy()&lt;br&gt;&amp;nbsp;↓&lt;br&gt;&amp;nbsp;bootstrap:&lt;br&gt;&amp;nbsp; &amp;nbsp;configRef:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;apiVersion: bootstrap.cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;kind: KubeadmConfigTemplate&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;name: ...&lt;br&gt;&amp;nbsp;clusterName: ...&lt;br&gt;&amp;nbsp;failureDomain: ...&lt;br&gt;&amp;nbsp;infrastructureRef:&lt;br&gt;&amp;nbsp; &amp;nbsp;apiVersion: infrastructure.cluster.x-k8s.io/v1alpha6&lt;br&gt;&amp;nbsp; &amp;nbsp;kind: OpenStackMachineTemplate&lt;br&gt;&amp;nbsp; &amp;nbsp;name: ...&lt;br&gt;&amp;nbsp;version: ..." style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="1040" y="1280" width="360" height="250" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-29" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;endFill=0;startArrow=oval;startFill=1;entryPerimeter=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="hPpHi9FJG0RTQSSKOcHU-28" target="hPpHi9FJG0RTQSSKOcHU-26" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1050" y="1079" as="sourcePoint" />
            <mxPoint x="1000" y="1079" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-33" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="1820" as="sourcePoint" />
            <mxPoint x="500" y="2120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="440" y="1820" />
              <mxPoint x="440" y="2120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;Call ＜ syncReplicas ＞ function&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;This function scales &lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;Machine&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt; resources up or down.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;In the first creation sequence, this logic scale up Machine resource.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;1. Call ＜ runPreflightChecks ＞&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;2. Loop&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; - Call computeDesiredMachine to generate machineSpec&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; - Create bootstrapConfig&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - From &lt;b&gt;MachineSet.Spec.Template.Spec.BootStrap.ConfigRef&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - Generate &lt;b&gt;KubeadmConfig&lt;/b&gt; from &lt;b&gt;KubeadmConfigTemplate&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; - Create infraMachine&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - From &lt;b&gt;MachineSet.Spec.Template.Spec.InfrastructureRef&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - Generate &lt;b&gt;OpenStackMachine&lt;/b&gt; from &lt;b&gt;OpenStackMachineTemplate&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; - Create the Machine&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - &lt;b&gt;Machine.Spec.BootstrapConfigRef&lt;/b&gt; = ${&lt;b&gt;Generated KubeadmConfig&lt;/b&gt;}&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - &lt;b&gt;Machine.Spec.InfrastructureRef&lt;/b&gt; = ${&lt;b&gt;Generated OpenStackMachine&lt;/b&gt;}&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; - waitForMachineCreation&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machineset/machineset_controller.go#L311" id="hPpHi9FJG0RTQSSKOcHU-34">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="30" y="1830" width="450" height="260" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-35" value="&amp;nbsp;Let&lt;br&gt;&amp;nbsp; &amp;nbsp;# Reuse MachineSet.Spec.Template.Spec, but drop some fields.&lt;br&gt;&amp;nbsp; &amp;nbsp;spec = machineSet.Spec.Template.Spec&lt;br&gt;&amp;nbsp; &amp;nbsp;spec.ClusterName = machineSet.Spec.ClusterName&lt;br&gt;&amp;nbsp; &amp;nbsp;spec.InfrastructureRef = corev1.Objectreference{}&lt;br&gt;&amp;nbsp; &amp;nbsp;spec.Bootstrap.ConfigRef = nil&lt;br&gt;&lt;br&gt;&amp;nbsp;apiVersion: cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp;kind: Machine&lt;br&gt;&amp;nbsp;metadata:&lt;br&gt;&amp;nbsp; &amp;nbsp;name: GenerateName(&quot;${machineSet.Name}-&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp;namespace: ${machineSet.Namespace}&lt;br&gt;&amp;nbsp; &amp;nbsp;ownerReferences:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- apiVersion: cluster.x-k8s.io/v1beta1&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kind: MachineSet&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Name: ${machineSet.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;UID: ${machineSet.UID}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;blockOwnerDeletion: true&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;controller: true&lt;br&gt;&amp;nbsp; &amp;nbsp;Finalizer:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- machine.cluster.x-k8s.io&lt;br&gt;&amp;nbsp;spec:&lt;br&gt;&amp;nbsp; &amp;nbsp;bootstrap:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;configRef: ${&lt;b&gt;Generated KubeadmConfig&lt;/b&gt;}&lt;br&gt;&amp;nbsp; &amp;nbsp;infrastructureRef: ${&lt;b&gt;Generated OpenStackMachine&lt;/b&gt;}&lt;br&gt;&amp;nbsp; &amp;nbsp;...${spec}" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="-183" y="2145" width="365" height="432" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-38" value="" style="endArrow=none;html=1;rounded=0;entryX=0;entryY=0.382;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;startArrow=oval;startFill=1;entryPerimeter=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="hPpHi9FJG0RTQSSKOcHU-35" target="hPpHi9FJG0RTQSSKOcHU-34" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="190" y="2080" as="sourcePoint" />
            <mxPoint x="240" y="2030" as="targetPoint" />
            <Array as="points">
              <mxPoint y="2140" />
              <mxPoint y="1930" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-42" value="" style="endArrow=classic;html=1;rounded=0;exitX=-0.001;exitY=0.614;exitDx=0;exitDy=0;exitPerimeter=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="hPpHi9FJG0RTQSSKOcHU-34" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-50" y="2070" as="sourcePoint" />
            <mxPoint x="-400" y="1990" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-43" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.833;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="265.8599999999997" y="1946" as="sourcePoint" />
            <mxPoint x="1277" y="1947.34" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-44" value="Reconcile &lt;b&gt;OpenStackMachine&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="-680" y="2019" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-45" value="Create &lt;b&gt;OpenStackMachine&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="-680" y="1975" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-46" value="Create &lt;b&gt;KubeadmConfig&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="1279" y="1932" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-47" value="Reconcile &lt;b&gt;KubeadmConfig&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="1279" y="1982" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-48" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1539" y="1997" as="sourcePoint" />
            <mxPoint x="1539" y="2092" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1599" y="1997" />
              <mxPoint x="1599" y="2092" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;Waiting for set&lt;br&gt;&lt;b&gt;KubeadmConfig.metadata.ownerReferences&lt;/b&gt;&lt;br&gt;to &lt;b&gt;Machine&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go#L161-L166" id="hPpHi9FJG0RTQSSKOcHU-49">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="1552" y="2011" width="280" height="61" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-50" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="hPpHi9FJG0RTQSSKOcHU-49" target="hPpHi9FJG0RTQSSKOcHU-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-51" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-400" y="2034" as="sourcePoint" />
            <mxPoint x="-400" y="2148" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-340" y="2034" />
              <mxPoint x="-341" y="2148" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="Waiting for set&lt;br&gt;&lt;b&gt;OpenStackMachine.metadata.ownerReferences&lt;br&gt;&lt;/b&gt;to&amp;nbsp;&lt;b&gt;Machine&lt;br&gt;&lt;/b&gt;" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackmachine_controller.go#L93-L101" id="hPpHi9FJG0RTQSSKOcHU-52">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="-391" y="2068" width="340" height="50" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-53" value="Reconcile &lt;b&gt;MachineSet&lt;/b&gt;&amp;nbsp;Controller" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="150" y="2625" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-54" value="" style="endArrow=none;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=classic;startFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" target="hPpHi9FJG0RTQSSKOcHU-53" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="460" y="3950" as="sourcePoint" />
            <mxPoint x="370" y="2725" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-55" value="" style="endArrow=classic;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" target="hPpHi9FJG0RTQSSKOcHU-53" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="2595" as="sourcePoint" />
            <mxPoint x="370" y="2635" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-56" value="Create &lt;b&gt;MachineSet&lt;/b&gt;&amp;nbsp;Resource" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=10;notch=0;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="200" y="2580" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-57" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="2150" as="sourcePoint" />
            <mxPoint x="500" y="2250" as="targetPoint" />
            <Array as="points">
              <mxPoint x="440" y="2150" />
              <mxPoint x="440" y="2250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&amp;nbsp;Call ＜ updateStatus ＞ function&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;It checks for the currrent state of replicas&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;and updates the Status of the &lt;b&gt;MachineSet&lt;/b&gt;&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machineset/machineset_controller.go#L315-L317" id="hPpHi9FJG0RTQSSKOcHU-58">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="210" y="2160" width="270" height="80" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-60" value="" style="endArrow=none;dashed=1;html=1;rounded=0;exitX=0;exitY=0;exitDx=365;exitDy=231;exitPerimeter=0;entryX=0;entryY=0;entryDx=145;entryDy=0;entryPerimeter=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="hPpHi9FJG0RTQSSKOcHU-35" target="hPpHi9FJG0RTQSSKOcHU-56" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="230" y="2400" as="sourcePoint" />
            <mxPoint x="280" y="2350" as="targetPoint" />
            <Array as="points">
              <mxPoint x="345" y="2376" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hPpHi9FJG0RTQSSKOcHU-62" value="&lt;div&gt;&lt;b&gt;The process after this line should be basically the same as the sequence diagram of KCP creation.&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Therefore, a detailed sequence diagram is omitted here（please check the 「kcp creation sequence diagram」sheet）.&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;On the other hand, it is necessary to mention KubeadmConfig because the worker node performams the 「kubeadm join」command instead of 「kubeadm init」command,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;so you should check and understand the processing part of KubeadmConfig for worker node.&lt;/b&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="-520" y="3040" width="2210" height="150" as="geometry" />
        </mxCell>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-2" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="1490" as="sourcePoint" />
            <mxPoint x="500" y="1620" as="targetPoint" />
            <Array as="points">
              <mxPoint x="460" y="1490" />
              <mxPoint x="460" y="1620" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="＜ reconcileExternalTemplateReference ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Get MachineSet.Spec.Template.Spec.InfrastructureRef（OpenStackMachineTemplate）&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Set&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; OpenStackMachineTemplate&lt;/font&gt;&lt;/div&gt;" id="hPpHi9FJG0RTQSSKOcHU-30">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="-35" y="1510" width="525" height="90" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-3" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="1650" as="sourcePoint" />
            <mxPoint x="500" y="1780" as="targetPoint" />
            <Array as="points">
              <mxPoint x="460" y="1650" />
              <mxPoint x="460" y="1780" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="＜ reconcileExternalTemplateReference ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Get MachineSet.Spec.Template.Spec.InfrastructureRef（OpenStackMachineTemplate）&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Set&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; OpenStackMachineTemplate&lt;/font&gt;&lt;/div&gt;" id="YnfTjMyZaVmJ1CAJGvWO-0">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="-35" y="1670" width="525" height="90" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-6" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="470" as="sourcePoint" />
            <mxPoint x="540" y="600" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="470" />
              <mxPoint x="600" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-7" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="650" as="sourcePoint" />
            <mxPoint x="540" y="780" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="650" />
              <mxPoint x="600" y="780" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="＜ reconcileExternalTemplateReference ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Get MachineSet.Spec.Template.Spec.InfrastructureRef（OpenStackMachineTemplate）&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Set&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; OpenStackMachineTemplate&lt;/font&gt;&lt;/div&gt;" id="YnfTjMyZaVmJ1CAJGvWO-5">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="670" width="525" height="90" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="＜ reconcileExternalTemplateReference ＞&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Get MachineSet.Spec.Template.Spec.InfrastructureRef（OpenStackMachineTemplate）&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Set&amp;nbsp;&lt;font style=&quot;border-color: var(--border-color);&quot; color=&quot;#0000ff&quot;&gt;OwnerReference : Cluster -(own)-&amp;gt; OpenStackMachineTemplate&lt;/font&gt;&lt;/div&gt;" id="YnfTjMyZaVmJ1CAJGvWO-4">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="550" y="490" width="525" height="90" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-8" value="" style="endArrow=classic;html=1;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="YnfTjMyZaVmJ1CAJGvWO-9" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="458" y="3250" as="sourcePoint" />
            <mxPoint x="1539" y="3250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-12" value="" style="endArrow=none;html=1;rounded=0;endFill=0;" parent="N3ns5-h5SZMH1uxuNw64-1" target="YnfTjMyZaVmJ1CAJGvWO-9" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="460" y="3250" as="sourcePoint" />
            <mxPoint x="1539" y="3250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <UserObject label="Set&amp;nbsp;&lt;font color=&quot;#0000ff&quot; style=&quot;border-color: var(--border-color); text-align: left;&quot;&gt;OwnerReference : Machine -(own)-&amp;gt; KubeadmConfigs&lt;/font&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller_phases.go#L180" id="YnfTjMyZaVmJ1CAJGvWO-9">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="660" y="3230" width="360" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-13" value="" style="endArrow=classic;html=1;rounded=0;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="N3ns5-h5SZMH1uxuNw64-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1539" y="3250" as="sourcePoint" />
            <mxPoint x="1540" y="3620" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1599" y="3250" />
              <mxPoint x="1599" y="3620" />
            </Array>
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;div style=&quot;text-align: center;&quot;&gt;&amp;nbsp;＜ joinWorker&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・Retrieve Secret&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;- Get existing ca.crt from &lt;b&gt;Secret&lt;/b&gt; named &amp;lt;ClusterName&amp;gt;-ca&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・Call ＜ reconcileDiscovery ＞ to set &lt;b&gt;KubeadmConfig.Spec.JoinConfiguration.Discovery&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/b&gt;- （The case that &lt;b&gt;KubeadmConfig.Spec.JoinConfiguration.Discovery&lt;/b&gt; doesn&#39;t provided from user）&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;　　- &lt;b&gt;KubeadmConfig.Spec.JoinConfiguration.Discovery.BootstrapToken&lt;/b&gt; = &amp;amp;bootstrapv1.BootstrapTokenDiscovery()&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;- &lt;b&gt;KubeadmConfig.Spec.JoinConfiguration.Discovery.BootstrapToken.CACertHashes &lt;/b&gt;= certificates.GetByPurpose(ClusterCA).Hashes()&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;- &lt;b&gt;KubeadmConfig.Spec.JoinConfiguration.Discovery.BootstrapToken.APIServerEndpoint&lt;/b&gt; =&lt;b&gt; Cluster.Spec.ControlPlaneEndpoint.&lt;/b&gt;String()&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;-&lt;b&gt; KubeadmConfig.Spec.JoinConfiguration.Discovery.BootstrapToken.Token&lt;/b&gt; = createToken()&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;- Call ＜ createToken ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - Generate token and use it to bootstrap.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; - Create Secret in WorkloadCluster named &quot;bootstrap-token-XXXX&quot;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・joinData from &lt;b&gt;KubeadmConfig.Spec.JoinConfigfuration&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・Call ＜ resolveFiles ＞ to map &lt;b&gt;KubeadmConfig.Spec.Files&lt;/b&gt; + kubeadm-join-config.yaml to cloudinit.files&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・Call ＜ resolveUsers ＞ to map&lt;b&gt; KubeadmConfig.Spec.Users&lt;/b&gt; to cloudinit.users&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・bootstrapJoinData = cloudinit.NewNode(nodeInput)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;- nodeInput contains the BaseUserData fields,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;and default BaseUserData.KubeadmCommand is &#39;kubeadm join ...&#39;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;- So, the generated data through ＜ joinWorker ＞ function contains the &#39;kubeadm join...&#39; command&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;・Call ＜ storeBootstrapData ＞&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;- Store the above userdata（cloudinit） as a &lt;b&gt;Secret&lt;/b&gt; resource.&lt;/div&gt;" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/bootstrap/kubeadm/internal/controllers/kubeadmconfig_controller.go" id="YnfTjMyZaVmJ1CAJGvWO-14">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="1560" y="3270" width="820" height="330" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-15" value="&amp;nbsp;Let&lt;br&gt;&amp;nbsp; &amp;nbsp;# Generate bootstrap token in controller&lt;br&gt;&amp;nbsp; &amp;nbsp;token = bootstraputils.GeenrateBootstrapToken() // e.g.&amp;nbsp;8tzsi7.g60unu838xsvtjq6&lt;br&gt;&amp;nbsp; &amp;nbsp;tokenID = 8tzsi7&lt;br&gt;&amp;nbsp; &amp;nbsp;tokenSecret = g60unu838xsvtjq6&lt;br&gt;&lt;br&gt;&amp;nbsp;apiVersion: v1&lt;br&gt;&amp;nbsp;kind: Secret&lt;br&gt;&amp;nbsp;metadata:&lt;br&gt;&amp;nbsp; &amp;nbsp;name: bootstrap-token-${tokenID}&lt;br&gt;&amp;nbsp; &amp;nbsp;namespace: kube-system&lt;br&gt;&amp;nbsp;data:&lt;br&gt;&amp;nbsp; &amp;nbsp;auth-extra-groups: base64( &quot;system:bootstrappers:kubeadm:default-node-token&quot; )&lt;br&gt;&amp;nbsp; &amp;nbsp;expiration: base64( time.Now().UTC().Add(ttl).Format(time.RFC3339)) )&lt;br&gt;&amp;nbsp; &amp;nbsp;token-id: base64( ${tokenID} )&lt;br&gt;&amp;nbsp; &amp;nbsp;token-secret: base64( ${tokenSecret} )&lt;br&gt;&amp;nbsp; &amp;nbsp;usage-bootstrap-authentication: base64( &quot;true&quot; )&lt;br&gt;&amp;nbsp; &amp;nbsp;usage-bootstrap-signing: base64 ( &quot;true&quot; )" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="1930" y="2950" width="520" height="310" as="geometry" />
        </mxCell>
        <mxCell id="YnfTjMyZaVmJ1CAJGvWO-16" value="" style="endArrow=oval;html=1;rounded=0;entryX=0.945;entryY=0.999;entryDx=0;entryDy=0;entryPerimeter=0;endFill=1;exitX=0.512;exitY=0.545;exitDx=0;exitDy=0;exitPerimeter=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="YnfTjMyZaVmJ1CAJGvWO-14" target="YnfTjMyZaVmJ1CAJGvWO-15" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1970" y="3490" as="sourcePoint" />
            <mxPoint x="2020" y="3440" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2421" y="3450" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="pzUe1JNEk4KS3dmxhFzR-0" value="&amp;nbsp;apiVersion: v1&lt;br&gt;&amp;nbsp;type: cluster.x-k8s.io/secret&lt;br&gt;&amp;nbsp;kind: Secret&lt;br&gt;&amp;nbsp;metadata:&lt;br&gt;&amp;nbsp; &amp;nbsp;name: ${kubeadmConfig.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp;namespace: ${kubeadmConfig.Namespace}&lt;br&gt;&amp;nbsp; &amp;nbsp;labels:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- cluster.x-k8s.io/cluster-name: ${cluster.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp;ownerReferences:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;- apiVersion:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;controller: true&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kind: KubeadmConfig&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;name: ${kubeadmConfig.Name}&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;uid: ${kubeadmConfig.UID}&lt;br&gt;&amp;nbsp;data:&lt;br&gt;&amp;nbsp; &amp;nbsp;value: base64( ${cloudinit} )" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;align=left;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="1970" y="3660" width="290" height="260" as="geometry" />
        </mxCell>
        <mxCell id="pzUe1JNEk4KS3dmxhFzR-1" value="" style="endArrow=classic;html=1;rounded=0;" parent="N3ns5-h5SZMH1uxuNw64-1" source="pzUe1JNEk4KS3dmxhFzR-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1541" y="3620" as="sourcePoint" />
            <mxPoint x="650" y="3620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="pzUe1JNEk4KS3dmxhFzR-3" value="" style="endArrow=none;html=1;rounded=0;endFill=0;" parent="N3ns5-h5SZMH1uxuNw64-1" target="pzUe1JNEk4KS3dmxhFzR-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1541" y="3620" as="sourcePoint" />
            <mxPoint x="550" y="3620" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <UserObject label="&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;KubeadmConfig.Status.Ready&amp;nbsp;&lt;/b&gt;is&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&amp;nbsp;True&lt;/b&gt;" id="pzUe1JNEk4KS3dmxhFzR-2">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;align=center;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
            <mxGeometry x="881" y="3600" width="360" height="40" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="pzUe1JNEk4KS3dmxhFzR-4" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="590" y="3615" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="pzUe1JNEk4KS3dmxhFzR-7" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="560" y="3615" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="pzUe1JNEk4KS3dmxhFzR-8" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="N3ns5-h5SZMH1uxuNw64-1" vertex="1">
          <mxGeometry x="530" y="3615" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="pzUe1JNEk4KS3dmxhFzR-9" value="" style="endArrow=oval;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;endFill=1;" parent="N3ns5-h5SZMH1uxuNw64-1" target="pzUe1JNEk4KS3dmxhFzR-0" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1920" y="3580" as="sourcePoint" />
            <mxPoint x="1970" y="3530" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2115" y="3580" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="1GsGqCXN8Yxk1cSTd2W0" name="capo-controllers">
    <mxGraphModel dx="1904" dy="845" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="PSVwS57urpKRihPEUnA6-4" value="Custom Resources" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="60" y="230" width="270" height="470" as="geometry" />
        </mxCell>
        <UserObject label="cluster-api openstack provider（v0.7.3）" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/tree/v0.7.3" id="6x-fGDOkvUFNguMoq0eM-1">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="354" y="100" width="416" height="80" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="YcCoLd1lFOuyd9ay4IwW-3" value="infrav1.OpenStackCluster" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="260" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="YcCoLd1lFOuyd9ay4IwW-5" value="clusterv1.Cluster" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="370" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="YcCoLd1lFOuyd9ay4IwW-9" value="　infnrav1 =&amp;gt;&amp;nbsp;cluster-api-provider-openstack/api/v1alpha6&lt;br&gt;　clusterv1 =&amp;gt;&amp;nbsp;cluster-api/api/v1beta1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;align=left;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="10" y="100" width="330" height="80" as="geometry" />
        </mxCell>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-2" value="infrav1.OpenStackMachine" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="485" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="YcCoLd1lFOuyd9ay4IwW-6" value="" style="endArrow=none;html=1;entryX=0.25;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=0;startArrow=classic;startFill=1;" parent="1" source="YcCoLd1lFOuyd9ay4IwW-5" target="6x-fGDOkvUFNguMoq0eM-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="445" y="500" as="sourcePoint" />
            <mxPoint x="570" y="360" as="targetPoint" />
            <Array as="points">
              <mxPoint x="460" y="405" />
              <mxPoint x="460" y="180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="PSVwS57urpKRihPEUnA6-2" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;Watch&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YcCoLd1lFOuyd9ay4IwW-6" connectable="0" vertex="1">
          <mxGeometry x="-0.4396" y="-1" relative="1" as="geometry">
            <mxPoint x="-12" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YcCoLd1lFOuyd9ay4IwW-7" value="" style="endArrow=classic;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;fillColor=#f5f5f5;strokeColor=#000000;endFill=1;" parent="1" target="YcCoLd1lFOuyd9ay4IwW-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="460" y="295" as="sourcePoint" />
            <mxPoint x="360" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="PSVwS57urpKRihPEUnA6-1" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;For&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YcCoLd1lFOuyd9ay4IwW-7" connectable="0" vertex="1">
          <mxGeometry x="-0.0769" y="2" relative="1" as="geometry">
            <mxPoint y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <UserObject label="OpenStackClusterReconciler&lt;br&gt;SetupManager" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackcluster_controller.go#L570-L609" id="hl4J_RicK7asCBebP2-g-1">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="344" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-6" value="clusterv1.Machine" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="600" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-7" value="" style="endArrow=none;html=1;entryX=0.779;entryY=1.004;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;rounded=0;startArrow=classic;startFill=1;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="BuDaOQ2_HBmb9qC5fw9n-2" target="6x-fGDOkvUFNguMoq0eM-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="460" y="465" as="sourcePoint" />
            <mxPoint x="638" y="240" as="targetPoint" />
            <Array as="points">
              <mxPoint x="280" y="520" />
              <mxPoint x="680" y="520" />
              <mxPoint x="680" y="180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-8" value="「&lt;font color=&quot;#ff0000&quot;&gt;&lt;b&gt;For&lt;/b&gt;&lt;/font&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="BuDaOQ2_HBmb9qC5fw9n-7" connectable="0" vertex="1">
          <mxGeometry x="-0.4396" y="-1" relative="1" as="geometry">
            <mxPoint x="-12" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <UserObject label="OpenStackMachineReconciler&lt;br&gt;SetupManager" link="https://github.com/kubernetes-sigs/cluster-api-provider-openstack/blob/v0.7.3/controllers/openstackmachine_controller.go#L192-L225" id="BuDaOQ2_HBmb9qC5fw9n-4">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="570" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-9" value="" style="endArrow=none;html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;startArrow=classic;startFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="YcCoLd1lFOuyd9ay4IwW-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="280" y="300" as="sourcePoint" />
            <mxPoint x="680" y="460" as="targetPoint" />
            <Array as="points">
              <mxPoint x="280" y="330" />
              <mxPoint x="340" y="330" />
              <mxPoint x="340" y="460" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-13" value="" style="endArrow=none;html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;startArrow=classic;startFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="YcCoLd1lFOuyd9ay4IwW-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="290" y="305" as="sourcePoint" />
            <mxPoint x="680" y="460" as="targetPoint" />
            <Array as="points">
              <mxPoint x="280" y="460" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-15" value="「&lt;b&gt;&lt;font color=&quot;#ff031c&quot;&gt;Watch&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="BuDaOQ2_HBmb9qC5fw9n-13" connectable="0" vertex="1">
          <mxGeometry x="0.4066" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="BuDaOQ2_HBmb9qC5fw9n-14" value="" style="endArrow=none;html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;startArrow=classic;startFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="BuDaOQ2_HBmb9qC5fw9n-6" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="607.48" as="sourcePoint" />
            <mxPoint x="430" y="460" as="targetPoint" />
            <Array as="points">
              <mxPoint x="400" y="635" />
              <mxPoint x="400" y="460" />
              <mxPoint x="420" y="460" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="fJfRLFwB4LryNWWHjsvg" name="capi-control-plane-controllers">
    <mxGraphModel dx="1904" dy="845" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="OAHNsvkbCxS2kmJfni2B-1" value="Custom Resources" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="60" y="240" width="270" height="360" as="geometry" />
        </mxCell>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-2" value="cluster-api （v1.5.1）&lt;br&gt;&lt;br&gt;controlplane.kubeadm" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="380" y="100" width="246" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-3" value="clusterv1.Cluster" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="470" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-4" value="clusterv1.Machine" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="370" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-10" value="　controlplanev1 =&amp;gt; cluster-api/controlplane/kubeadm/api/v1beta1&lt;br&gt;　clusterv1 =&amp;gt;&amp;nbsp;cluster-api/api/v1beta1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;align=left;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="10" y="100" width="360" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-6" value="" style="endArrow=none;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=0;startArrow=classic;startFill=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="280" y="504.5" as="sourcePoint" />
            <mxPoint x="503.0000000000001" y="182" as="targetPoint" />
            <Array as="points">
              <mxPoint x="503" y="505" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-7" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;Watch&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="OAHNsvkbCxS2kmJfni2B-6" connectable="0" vertex="1">
          <mxGeometry x="-0.4396" y="-1" relative="1" as="geometry">
            <mxPoint x="-12" y="-4" as="offset" />
          </mxGeometry>
        </mxCell>
        <UserObject label="KubeadmControlePlaneReconciler&lt;br&gt;SetupManager" id="OAHNsvkbCxS2kmJfni2B-11">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="398" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-8" value="" style="endArrow=classic;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;fillColor=#f5f5f5;strokeColor=#000000;endFill=1;" parent="1" target="OAHNsvkbCxS2kmJfni2B-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="503" y="405" as="sourcePoint" />
            <mxPoint x="280.11" y="404.72" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OAHNsvkbCxS2kmJfni2B-9" value="「&lt;font color=&quot;#ff0000&quot;&gt;&lt;b&gt;Own&lt;/b&gt;&lt;/font&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="OAHNsvkbCxS2kmJfni2B-8" connectable="0" vertex="1">
          <mxGeometry x="-0.0769" y="2" relative="1" as="geometry">
            <mxPoint x="14" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="M4M5IeH_oS6YpcaPkxup-1" value="controlplanev1.&lt;br&gt;KubeadmControlPlane" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="270" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="M4M5IeH_oS6YpcaPkxup-3" value="" style="endArrow=classic;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;fillColor=#f5f5f5;strokeColor=#000000;endFill=1;" parent="1" target="M4M5IeH_oS6YpcaPkxup-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="503" y="305" as="sourcePoint" />
            <mxPoint x="283" y="305" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="M4M5IeH_oS6YpcaPkxup-4" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;For&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="M4M5IeH_oS6YpcaPkxup-3" connectable="0" vertex="1">
          <mxGeometry x="-0.0769" y="2" relative="1" as="geometry">
            <mxPoint x="14" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="jB_KwWKISDssQRoUF651" name="capi-controllers">
    <mxGraphModel dx="1904" dy="845" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="fGLC1GtY3dB90ok2cL7G-1" value="Custom Resources" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="60" y="230" width="270" height="570" as="geometry" />
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-2" value="cluster-api （v1.5.1）" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="354" y="100" width="1456" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-3" value="clusterv1.Cluster" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="260" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-4" value="clusterv1.Machine" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="370" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-5" value="" style="group" parent="1" connectable="0" vertex="1">
          <mxGeometry x="449" y="295" as="geometry" />
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-6" value="" style="endArrow=none;html=1;entryX=0.065;entryY=1.046;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=0;startArrow=classic;startFill=1;entryPerimeter=0;" parent="fGLC1GtY3dB90ok2cL7G-5" source="fGLC1GtY3dB90ok2cL7G-4" target="fGLC1GtY3dB90ok2cL7G-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-4" y="205.1" as="sourcePoint" />
            <mxPoint x="121" y="65.1" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-7" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;Watch&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="fGLC1GtY3dB90ok2cL7G-6" connectable="0" vertex="1">
          <mxGeometry x="-0.4396" y="-1" relative="1" as="geometry">
            <mxPoint x="-12" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-8" value="" style="endArrow=classic;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;fillColor=#f5f5f5;strokeColor=#000000;endFill=1;" parent="fGLC1GtY3dB90ok2cL7G-5" target="fGLC1GtY3dB90ok2cL7G-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint as="sourcePoint" />
            <mxPoint x="-89" y="5.099999999999994" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-9" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;For&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="fGLC1GtY3dB90ok2cL7G-8" connectable="0" vertex="1">
          <mxGeometry x="-0.0769" y="2" relative="1" as="geometry">
            <mxPoint y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-10" value="　clusterv1 =&amp;gt;&amp;nbsp;cluster-api/api/v1beta1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;align=left;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="10" y="100" width="330" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="fGLC1GtY3dB90ok2cL7G-13" target="fGLC1GtY3dB90ok2cL7G-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="610" y="460" as="targetPoint" />
            <Array as="points">
              <mxPoint x="449" y="180" />
              <mxPoint x="710" y="180" />
              <mxPoint x="710" y="440" />
              <mxPoint x="280" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-12" value="「&lt;b&gt;&lt;font color=&quot;#ff031c&quot;&gt;For&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="fGLC1GtY3dB90ok2cL7G-11" connectable="0" vertex="1">
          <mxGeometry x="0.5414" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <UserObject label="ClusterReconciler&lt;br&gt;SetupManager" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/cluster/cluster_controller.go#L80-L88" id="fGLC1GtY3dB90ok2cL7G-13">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="344" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="MachineReconciler&lt;br&gt;SetupManager" link="https://github.com/kubernetes-sigs/cluster-api/blob/main/internal/controllers/machine/machine_controller.go#L108-L125" id="fGLC1GtY3dB90ok2cL7G-14">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="600" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="MachineSetReconciler&lt;br&gt;SetupWithManager" id="fGLC1GtY3dB90ok2cL7G-15">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="850" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="MachineDeploymentReconciler&lt;br&gt;SetupWithManager" id="fGLC1GtY3dB90ok2cL7G-16">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="1080" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="MachineHealthCheckReconciler&lt;br&gt;SetupWithManager" id="fGLC1GtY3dB90ok2cL7G-17">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="1320" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-18" value="" style="group" parent="1" connectable="0" vertex="1">
          <mxGeometry x="1560" y="200" width="220" height="90" as="geometry" />
        </mxCell>
        <UserObject label="featureGaters..." id="fGLC1GtY3dB90ok2cL7G-19">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;container=1;" parent="fGLC1GtY3dB90ok2cL7G-18" vertex="1">
            <mxGeometry x="30" y="30" width="190" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="featureGaters..." id="fGLC1GtY3dB90ok2cL7G-20">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;container=1;" parent="fGLC1GtY3dB90ok2cL7G-18" vertex="1">
            <mxGeometry x="20" y="20" width="190" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="featureGaters..." id="fGLC1GtY3dB90ok2cL7G-21">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="fGLC1GtY3dB90ok2cL7G-18" vertex="1">
            <mxGeometry x="10" y="10" width="190" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="featureGaters..." id="fGLC1GtY3dB90ok2cL7G-22">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="fGLC1GtY3dB90ok2cL7G-18" vertex="1">
            <mxGeometry width="190" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-23" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" target="fGLC1GtY3dB90ok2cL7G-3" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="710" y="325" as="sourcePoint" />
            <mxPoint x="280" y="310" as="targetPoint" />
            <Array as="points">
              <mxPoint x="280" y="326" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="fGLC1GtY3dB90ok2cL7G-24" value="「&lt;b&gt;&lt;font color=&quot;#ff031c&quot;&gt;Watch&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="fGLC1GtY3dB90ok2cL7G-23" connectable="0" vertex="1">
          <mxGeometry x="-0.4666" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="9yOwVbE0o5gcLiuX17Gm" name="capi-kubeadm-bootstrap-controllers">
    <mxGraphModel dx="1904" dy="1061" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-1" value="Custom Resources" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=bottom;" parent="1" vertex="1">
          <mxGeometry x="60" y="240" width="270" height="360" as="geometry" />
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-2" value="cluster-api （v1.5.1）&lt;br&gt;&lt;br&gt;bootstrap.kubeadm" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="380" y="100" width="246" height="80" as="geometry" />
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-3" value="clusterv1.Cluster" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="470" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-4" value="clusterv1.Machine" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="370" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-5" value="　bootstrapv1 =&amp;gt;&amp;nbsp;cluster-api/bootstrap/kubeadm/api/v1beta1&lt;br&gt;　clusterv1 =&amp;gt;&amp;nbsp;cluster-api/api/v1beta1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;align=left;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="10" y="100" width="360" height="80" as="geometry" />
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-6" value="" style="endArrow=none;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.5;exitDx=0;exitDy=0;rounded=0;startArrow=classic;startFill=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="280" y="504.5" as="sourcePoint" />
            <mxPoint x="503.0000000000001" y="182" as="targetPoint" />
            <Array as="points">
              <mxPoint x="503" y="505" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-7" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;Watch&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="kpI6dHkBKFJ4kFH6QJoy-6" connectable="0" vertex="1">
          <mxGeometry x="-0.4396" y="-1" relative="1" as="geometry">
            <mxPoint x="-12" y="-4" as="offset" />
          </mxGeometry>
        </mxCell>
        <UserObject label="KubeadmConfigReconciler&lt;br&gt;SetupManager" id="kpI6dHkBKFJ4kFH6QJoy-8">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="398" y="200" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-9" value="" style="endArrow=classic;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;fillColor=#f5f5f5;strokeColor=#000000;endFill=1;" parent="1" target="kpI6dHkBKFJ4kFH6QJoy-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="503" y="405" as="sourcePoint" />
            <mxPoint x="280.11" y="404.72" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-10" value="「&lt;font color=&quot;#ff0000&quot;&gt;&lt;b&gt;Watch&lt;/b&gt;&lt;/font&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="kpI6dHkBKFJ4kFH6QJoy-9" connectable="0" vertex="1">
          <mxGeometry x="-0.0769" y="2" relative="1" as="geometry">
            <mxPoint x="20" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-11" value="bootstrapv1.KubeadmConfig" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="270" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-12" value="" style="endArrow=classic;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startArrow=none;startFill=0;fillColor=#f5f5f5;strokeColor=#000000;endFill=1;" parent="1" target="kpI6dHkBKFJ4kFH6QJoy-11" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="503" y="305" as="sourcePoint" />
            <mxPoint x="283" y="305" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kpI6dHkBKFJ4kFH6QJoy-13" value="「&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;For&lt;/font&gt;&lt;/b&gt;」" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="kpI6dHkBKFJ4kFH6QJoy-12" connectable="0" vertex="1">
          <mxGeometry x="-0.0769" y="2" relative="1" as="geometry">
            <mxPoint x="20" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
